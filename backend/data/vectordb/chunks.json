[
  "Giới  thiệu  tổng  quan  về  Airflow  \nApache  Airflow  là  một  công  cụ  nguồn  mở  để  tạo,  lên  lịch  và  giám  sát  quy  trình  công  việc  theo  chương  \ntrình.\n \nNó\n \nđược\n \ncác\n \nKỹ\n \nsư\n \nDữ\n \nliệu\n \nsử\n \ndụng\n \nđể\n \nđiều\n \nphối\n \nquy\n \ntrình\n \ncông\n \nviệc\n \nhoặc\n \nđường\n \nống.\n \nNgười\n \ndùng\n \ncó\n \nthể\n \ndễ\n \ndàng\n \nhình\n \ndung\n \ncác\n \nphụ\n \nthuộc,\n \ntiến\n \ntrình,\n \nnhật\n \nký,\n \nmã,\n \ntác\n \nvụ\n \nkích\n \nhoạt\n \nvà\n \ntrạng\n \nthái\n \nthành\n \ncông\n \ncủa\n \nđường\n \nống\n \ndữ\n \nliệu.\n \nNó\n \nquản\n \nlý\n \ncác\n \nđường\n \nống\n \ndữ\n \nliệu\n \nphức\n \ntạp.\n \nCác\n \nđường\n \nống\n \ndữ\n \nliệu\n \nnày\n \nđược\n \nsử\n \ndụng\n \nđể\n \ncung\n \ncấp\n \ncác\n \ntập\n \ndữ\n \nliệu\n \ndễ\n \ndàng\n \nsử\n \ndụng\n \nbởi\n \ncác\n \nứng\n \ndụng\n \ntrí\n \ntuệ\n \nkinh\n \ndoanh\n \nhoặc\n \ncác\n \nmô\n \nhình\n \nhọc\n \nmáy\n \ncần\n \nmột\n \nlượng\n \ndữ\n \nliệu\n \nkhổng\n \nlồ.\n \nĐây\n \nlà\n \nmột\n \ntrong\n \nnhững\n \nnền\n \ntảng\n \nmạnh\n \nmẽ\n \nnhất\n \ndành\n \ncho\n \ncác\n \nkỹ\n \nsư\n \ndữ\n \nliệu.\n 1.  Khởi  nguồn  &  các  giai  đoạn  đầu",
  "nền\n \ntảng\n \nmạnh\n \nmẽ\n \nnhất\n \ndành\n \ncho\n \ncác\n \nkỹ\n \nsư\n \ndữ\n \nliệu.\n 1.  Khởi  nguồn  &  các  giai  đoạn  đầu  \nApache  Airflow  ra  đời  vào  năm  2014  tại  Airbnb ,  do  Maxime  Beauchemin  khởi  xướng  nhằm  giải  \nquyết\n \nvấn\n \nđề\n \nquản\n \nlý\n \nvà\n \ntự\n \nđộng\n \nhóa\n \ncác\n \nluồng\n \ncông\n \nviệc\n \n(workflow)\n \nphân\n \ntích\n \ndữ\n \nliệu\n \nphức\n \ntạp\n \ntrong\n \nhệ\n \nthống\n \nphân\n \ntán\n \ncủa\n \ncông\n \nty.\n \nĐến\n \nnăm\n \n2015\n,\n \nAirflow\n \nđược\n \nchính\n \nthức\n \nphát\n \nhành\n \ndưới\n \ndạng\n \nmã\n \nnguồn\n \nmở\n,\n \nnhanh\n \nchóng\n \nthu\n \nhút\n \nsự\n \nquan\n \ntâm\n \ncủa\n \ncộng\n \nđồng\n \nkỹ\n \nsư\n \ndữ\n \nliệu.\n \nTháng\n \n3\n \nnăm\n \n2016,\n \ndự\n \nán\n \nđược\n \nApache\n \nSoftware\n \nFoundation\n \nchấp\n \nnhận\n \nvào\n \nchương\n \ntrình\n \nIncubator\n,\n \nđánh\n \ndấu\n \nbước\n \nngoặt\n \nlớn\n \nvề\n \ntính\n \nminh\n \nbạch,\n \nđộ\n \ntin\n \ncậy\n \nvà\n \nquy\n \nmô\n \ncộng\n \nđồng\n \nđóng\n \ngóp.\n \nĐến\n \nđầu\n \nnăm\n \n2019\n,\n \nAirflow\n \nđã\n \ntrưởng\n \nthành\n \nđủ\n \nđể\n \ntrở\n \nthành\n \nTop-Level\n \nProject\n \ncủa\n \nApache\n,\n \nthể\n \nhiện\n \nvị\n \nthế",
  "Airflow\n \nđã\n \ntrưởng\n \nthành\n \nđủ\n \nđể\n \ntrở\n \nthành\n \nTop-Level\n \nProject\n \ncủa\n \nApache\n,\n \nthể\n \nhiện\n \nvị\n \nthế\n \ncủa\n \nnó\n \nnhư\n \nmột\n \ncông\n \ncụ\n \nđiều\n \nphối\n \ndữ\n \nliệu\n \ntiêu\n \nchuẩn\n \ntrong\n \nhệ\n \nsinh\n \nthái\n \nBig\n \nData.\n \n2.  Bước  chuyển  lớn:  Airflow  2.0  \nNgày  17  tháng  12  năm  2020 ,  Airflow  2.0.0  chính  thức  ra  mắt  —  được  xem  là  phiên  bản  đột  \nphá\n \nnhất\n \nkể\n \ntừ\n \nkhi\n \ndự\n \nán\n \nra\n \nđời.\n \nPhiên\n \nbản\n \nnày\n \ngiới\n \nthiệu\n \nTaskFlow\n \nAPI\n,\n \ncho\n \nphép\n \nđịnh\n \nnghĩa\n \nDAGs\n \nbằng\n \ndecorator\n \nPython\n \n(@task),\n \ngiúp\n \ncode\n \ntrực\n \nquan,\n \ndễ\n \nkiểm\n \nthử\n \nvà\n \ndễ\n \nbảo\n \ntrì\n \nhơn.\n \nNgoài\n \nra,\n \nAirflow\n \n2.0\n \nmang\n \nđến\n \nREST\n \nAPI\n \nhoàn\n \nchỉnh\n \n(AIP-32)\n \ngiúp\n \ntự\n \nđộng\n \nhóa\n \nvà\n \ntích\n \nhợp\n \ndễ\n \ndàng\n \nhơn\n \ntrong\n \nmôi\n \ntrường\n \ndoanh\n \nnghiệp.\n \nScheduler\n \nđược\n \nthiết\n \nkế\n \nlại\n \nhoàn\n \ntoàn,\n \nhỗ\n \ntrợ\n \nđa\n \nluồng\n,\n \nphân\n \ntán\n \ncao\n,\n \nvà\n \nxử\n \nlý\n \nsong\n \nsong\n \nhiệu\n \nquả\n \nhơn\n,\n \nđưa\n \nAirflow\n \ntrở\n \nthành",
  "trợ\n \nđa\n \nluồng\n,\n \nphân\n \ntán\n \ncao\n,\n \nvà\n \nxử\n \nlý\n \nsong\n \nsong\n \nhiệu\n \nquả\n \nhơn\n,\n \nđưa\n \nAirflow\n \ntrở\n \nthành\n \nnền\n \ntảng\n \norchestration\n \ncó\n \nkhả\n \nnăng\n \nmở\n \nrộng\n \nthực\n \nsự.\n \nCác\n \nbản\n \nnhỏ\n \ntiếp\n \ntheo\n \nnhư\n \n2.2\n \nvà\n \n2.3\n \nbổ\n \nsung\n \ncác\n \ntính\n \nnăng\n \nquan\n \ntrọng\n \nnhư\n \nCustom\n \nTimetables\n \nvà\n \nDeferrable\n \nTasks\n,\n \ngiúp\n \ngiảm\n \ntải\n \nhệ\n \nthống\n \nvà\n \ntăng\n \ntính\n \nlinh\n \nhoạt\n \ntrong\n \nlập\n \nlịch.\n \nTrong  giai  đoạn  2023  –  2024 ,  Airflow  bước  vào  thời  kỳ  ổn  định  và  mở  rộng  quy  mô  triển  khai .  \nCác\n \nbản\n \nphát\n \nhành\n \ntrong\n \nchuỗi\n \n2.x,\n \nchẳng\n \nhạn\n \nnhư\n \nAirflow\n \n2.10.0\n \n(tháng\n \n8\n \nnăm\n \n2024)\n,\n \nmang\n \nđến\n \ngiao\n \ndiện\n \nngười\n \ndùng\n \nđược\n \ncải\n \ntiến\n \n(Dark\n \nMode,\n \nDataset\n \nUI),\n \nhệ\n \nthống\n \nlogging\n \nrõ\n \nràng\n \nhơn,\n \nvà\n \nkhả\n \nnăng\n \ngiám\n \nsát\n \ntask\n \nchi\n \ntiết.\n \nAirflow\n \ndần\n \nđược\n \ncác\n \ndoanh\n \nnghiệp\n \nlớn\n \ntrong\n \nlĩnh\n \nvực\n \ntài\n \nchính,\n \nthương\n \nmại\n \nđiện\n \ntử\n \nvà\n \ncông\n \nnghệ\n \nchấp",
  "các\n \ndoanh\n \nnghiệp\n \nlớn\n \ntrong\n \nlĩnh\n \nvực\n \ntài\n \nchính,\n \nthương\n \nmại\n \nđiện\n \ntử\n \nvà\n \ncông\n \nnghệ\n \nchấp\n \nnhận\n \nnhư\n \ncông\n \ncụ\n \norchestration\n \nmặc\n \nđịnh\n.\n \nTrong\n \nthời\n \nkỳ\n \nnày,\n \ncộng\n \nđồng\n \nbắt\n \nđầu\n \nhướng\n \nsự\n \nquan\n \ntâm\n \nđến\n \nviệc\n \nhỗ\n \ntrợ\n \nmachine\n \nlearning\n \nops\n \n(MLOps)\n,\n \nreal-time\n \norchestration\n,\n \nvà\n \ncác\n \nkiến\n \ntrúc\n \nlai\n \n(hybrid\n \ncloud).\n \nAirflow\n \ntrở\n \nthành\n \ntrụ\n \ncột\n \ntrong\n \nhệ\n \nsinh\n \nthái\n \ndữ\n \nliệu\n \nhiện\n \nđại,\n \nđứng\n \ncạnh\n \nSpark,\n \nKafka,\n \nvà\n \nKubernetes\n \nnhư\n \nmột\n \nmảnh\n \nghép\n \nquan\n \ntrọng\n \ncủa\n \nhệ\n \nthống\n \nphân\n \ntán.\n \n3.  Phiên  bản  hiện  tại  &  Airflow  3.x  \nTháng  4  năm  2025,  Apache  chính  thức  công  bố  Airflow  3.0 ,  được  mô  tả  là  “ bản  phát  hành  lớn  \nnhất\n \ntrong\n \nlịch\n \nsử\n \nAirflow\n”.\n \nPhiên\n \nbản\n \nnày\n \nmở\n \nrộng\n \ntầm\n \nnhìn\n \ntừ\n \ncông\n \ncụ\n \nETL/ELT\n \ntruyền\n \nthống\n \nthành\n \nnền\n \ntảng\n \norchestration\n \ntoàn\n \ndiện\n \ncho\n \ndữ\n \nliệu,\n \nMLOps\n \nvà\n \nAI\n \nworkflow\n.",
  "truyền\n \nthống\n \nthành\n \nnền\n \ntảng\n \norchestration\n \ntoàn\n \ndiện\n \ncho\n \ndữ\n \nliệu,\n \nMLOps\n \nvà\n \nAI\n \nworkflow\n.\n \nAirflow\n \n3.0\n \ngiới\n \nthiệu\n \nkiến\n \ntrúc\n \nTask\n \nSDK\n \ntách\n \nbiệt\n,\n \nhỗ\n \ntrợ\n \nversioning\n \nDAGs,\n \ncải\n \nthiện\n \nkhả\n \nnăng\n \nnâng\n \ncấp\n \nđộc\n \nlập\n \ngiữa\n \ncác\n \nthành\n \nphần.\n \nĐến\n \ntháng\n \n9\n \nnăm\n \n2025\n,\n \nAirflow\n \n3.1\n \nra\n \nmắt\n \nvới\n \ntính\n \nnăng\n \nnổi\n \nbật\n \nHuman-in-the-Loop\n \n(HITL)\n,\n \ncho\n \nphép\n \ncác\n \nquy\n \ntrình\n \ndừng\n \ntạm\n \nđể\n \nchờ\n \nngười\n \ndùng\n \nphê\n \nduyệt\n \nhoặc\n \nđưa\n \nra\n \nquyết\n \nđịnh\n \n—\n \nmở\n \nra\n \nhướng\n \nđi\n \nmới\n \ncho\n \norchestration\n \ntương\n \ntác.",
  "Motivation  for  Using  Airflow  in  Big  Data  Analysis  \n1.  Bối  cảnh  –  Những  vấn  đề  cần  giải  quyết  \nKhi  các  tổ  chức  bắt  đầu  thu  thập  và  khai  thác  lượng  dữ  liệu  khổng  lồ  từ  nhiều  nguồn  khác  nhau  \n—\n \ncơ\n \nsở\n \ndữ\n \nliệu,\n \nlog\n \nhệ\n \nthống,\n \ndịch\n \nvụ\n \nweb,\n \nthiết\n \nbị\n \nIoT,\n \nvà\n \nnền\n \ntảng\n \nđám\n \nmây\n \n—\n \nnhu\n \ncầu\n \nquản\n \nlý\n \ncác\n \nquy\n \ntrình\n \nxử\n \nlý\n \ndữ\n \nliệu\n \ntrở\n \nnên\n \nvô\n \ncùng\n \nphức\n \ntạp.\n \nMỗi\n \nquy\n \ntrình\n \n(pipeline)\n \nthường\n \nbao\n \ngồm\n \nnhiều\n \nbước\n \nnhư\n \ntrích\n \nxuất\n \ndữ\n \nliệu\n \n(Extract),\n \nlàm\n \nsạch\n \nvà\n \nchuyển\n \nđổi\n \n(Transform),\n \nsau\n \nđó\n \ntải\n \nlên\n \nhệ\n \nthống\n \nlưu\n \ntrữ\n \nhoặc\n \nkho\n \ndữ\n \nliệu\n \n(Load).\n \nTrong\n \nmôi\n \ntrường\n \ndữ\n \nliệu\n \nlớn,\n \ncác\n \nbước\n \nnày\n \nkhông\n \nchỉ\n \nphải\n \nđược\n \nthực\n \nhiện\n \nđúng\n \nthứ\n \ntự\n \nvà\n \nđúng\n \nthời\n \nđiểm\n,\n \nmà\n \ncòn\n \nphải\n \nđảm\n \nbảo\n \nhiệu\n \nnăng,\n \nđộ\n \ntin\n \ncậy\n \nvà\n \nkhả\n \nnăng\n \nmở\n \nrộng\n \ntrên\n \nnhiều\n \nmáy\n \nchủ\n \nhoặc\n \ncụm\n \nxử\n \nlý\n \nphân\n \ntán",
  "năng,\n \nđộ\n \ntin\n \ncậy\n \nvà\n \nkhả\n \nnăng\n \nmở\n \nrộng\n \ntrên\n \nnhiều\n \nmáy\n \nchủ\n \nhoặc\n \ncụm\n \nxử\n \nlý\n \nphân\n \ntán\n \n(distributed\n \nclusters).\n \nKhi\n \nchưa\n \ncó\n \nAirflow,\n \ncác\n \nkỹ\n \nsư\n \ndữ\n \nliệu\n \nthường\n \nsử\n \ndụng\n \ncron\n \njob\n,\n \nbash\n \nscripts\n \nhoặc\n \ntask\n \nscheduler\n \nnội\n \nbộ\n,\n \nnhưng\n \ncách\n \nnày\n \nnhanh\n \nchóng\n \ntrở\n \nnên\n \nkhông\n \nthể\n \nkiểm\n \nsoát\n \nkhi\n \nsố\n \nlượng\n \npipeline\n \ntăng\n \nlên.\n \nHọ\n \ngặp\n \nhàng\n \nloạt\n \nvấn\n \nđề:\n \nkhông\n \ncó\n \ngiao\n \ndiện\n \ntheo\n \ndõi,\n \nkhông\n \ncó\n \ncơ\n \nchế\n \ntự\n \nđộng\n \nkhôi\n \nphục\n \nhoặc\n \nretry\n \nkhi\n \ntask\n \nthất\n \nbại,\n \nkhó\n \nquản\n \nlý\n \nphụ\n \nthuộc\n \ngiữa\n \ncác\n \nbước,\n \nvà\n \nkhông\n \nthể\n \ndễ\n \ndàng\n \n“chạy\n \nlại\n \ndữ\n \nliệu\n \nlịch\n \nsử”\n \n(backfill).\n \nNgoài\n \nra,\n \nviệc\n \ntriển\n \nkhai\n \ntrên\n \nnhiều\n \nhệ\n \nthống\n \nkhác\n \nnhau\n \n(như\n \nSpark,\n \nHadoop,\n \nKafka,\n \nhoặc\n \ncác\n \ndịch\n \nvụ\n \nđám\n \nmây)\n \nkhiến\n \nviệc\n \nđiều\n \nphối\n \nvà\n \nđồng\n \nbộ\n \ndữ\n \nliệu\n \ngần\n \nnhư\n \nbất\n \nkhả\n \nthi\n \nnếu\n \nchỉ\n \ndựa\n \nvào\n \ncác\n \ncông",
  "việc\n \nđiều\n \nphối\n \nvà\n \nđồng\n \nbộ\n \ndữ\n \nliệu\n \ngần\n \nnhư\n \nbất\n \nkhả\n \nthi\n \nnếu\n \nchỉ\n \ndựa\n \nvào\n \ncác\n \ncông\n \ncụ\n \nđơn\n \ngiản.\n \nTất\n \ncả\n \nnhững\n \nkhó\n \nkhăn\n \nnày\n \ntạo\n \nnên\n \nnhu\n \ncầu\n \nbức\n \nthiết\n \nvề\n \nmột\n \nnền\n \ntảng\n \norchestration\n \nthống\n \nnhất\n \n–\n \ncó\n \nkhả\n \nnăng\n \nmô\n \ntả\n \npipeline\n \ndưới\n \ndạng\n \nmã\n \n(workflows\n \nas\n \ncode),\n \nthực\n \nthi\n \nsong\n \nsong,\n \ngiám\n \nsát\n \ntrực\n \nquan,\n \nvà\n \ntự\n \nđộng\n \nhóa\n \ntoàn\n \nbộ\n \nquy\n \ntrình\n \nxử\n \nlý\n \ndữ\n \nliệu\n \nphức\n \ntạp.\n \nĐây\n \ncũng\n \nchính\n \nlà\n \nđộng\n \nlực\n \nđể\n \nApache\n \nAirflow\n \nra\n \nđời.\n \n2.  Lợi  ích  của  Airflow  trong  phân  tích  dữ  liệu  lớn  (Big  Data  Analysis)  \nApache  Airflow  mang  lại  một  bước  tiến  lớn  trong  cách  quản  lý,  lập  lịch  và  vận  hành  các  pipeline  \ndữ\n \nliệu\n \nlớn.\n \nThay\n \nvì\n \nvận\n \nhành\n \nthủ\n \ncông\n \nhoặc\n \nrời\n \nrạc,\n \nAirflow\n \ncho\n \nphép\n \ncác\n \ntổ\n \nchức\n \nđịnh\n \nnghĩa\n \ntoàn\n \nbộ\n \nquy\n \ntrình\n \nxử\n \nlý\n \ndữ\n \nliệu\n \nnhư\n \nmột\n \nđồ\n \nthị\n \ncó\n \nhướng\n \n(DAG",
  "tổ\n \nchức\n \nđịnh\n \nnghĩa\n \ntoàn\n \nbộ\n \nquy\n \ntrình\n \nxử\n \nlý\n \ndữ\n \nliệu\n \nnhư\n \nmột\n \nđồ\n \nthị\n \ncó\n \nhướng\n \n(DAG\n \n–\n \nDirected\n \nAcyclic\n \nGraph)\n,\n \ntrong\n \nđó\n \nmỗi\n \ntác\n \nvụ\n \nđược\n \nbiểu\n \ndiễn\n \nrõ\n \nràng\n \nvà\n \ncó\n \nthể\n \nkiểm\n \nsoát\n \nthứ\n \ntự\n \nphụ\n \nthuộc\n \ngiữa\n \nchúng.\n \nĐiều\n \nnày\n \ngiúp\n \nđảm\n \nbảo\n \nmọi\n \nbước\n \nxử\n \nlý\n \nđều\n \nchạy\n \nđúng\n \nthứ\n \ntự,\n \nđúng\n \nlịch,\n \nvà\n \ndễ\n \ndàng\n \nmở\n \nrộng\n \nkhi\n \ndữ\n \nliệu\n \ntăng\n \nlên.\n \nViệc\n \nmô\n \nhình\n \nhóa\n \npipeline\n \nbằng\n \nPython\n \ncode\n \ngiúp\n \ncác\n \nkỹ\n \nsư\n \ndữ\n \nliệu\n \ncó\n \nthể\n \náp\n \ndụng\n \ncác\n \nphương\n \npháp\n \nhiện\n \nđại\n \nnhư\n \nversion\n \ncontrol\n,\n \ncode\n \nreview\n,\n \ntesting\n \nvà\n \ntái\n \nsử\n \ndụng\n \nmã\n,\n \nbiến\n \nworkflow\n \ntừ\n \nnhững\n \ntập\n \nlệnh\n \nthủ\n \ncông\n \nthành\n \nmột\n \nsản\n \nphẩm\n \nphần\n \nmềm\n \ncó\n \nthể\n \nbảo\n \ntrì\n \nvà\n \nphát\n \ntriển\n \nlâu\n \ndài\n.\n \nAirflow\n \ncòn\n \ncung\n \ncấp\n \nhệ\n \nthống\n \nExecutor\n \nphân\n \ntán\n \n(như\n \nCeleryExecutor\n \nhoặc\n \nKubernetesExecutor),\n \ncho\n \nphép\n \nchạy\n \nhàng\n \nnghìn",
  "Executor\n \nphân\n \ntán\n \n(như\n \nCeleryExecutor\n \nhoặc\n \nKubernetesExecutor),\n \ncho\n \nphép\n \nchạy\n \nhàng\n \nnghìn\n \ntác\n \nvụ\n \nsong\n \nsong\n \ntrên\n \nnhiều\n \nmáy\n \nchủ,\n \ngiúp\n \nđáp\n \nứng\n \nkhối\n \nlượng\n \ndữ\n \nliệu\n \nkhổng\n \nlồ\n \ntrong\n \ncác\n \ndự\n \nán\n \nBig\n \nData.\n \nNgoài\n \nra,\n \nvới\n \ngiao\n \ndiện\n \nweb\n \ntrực\n \nquan\n,\n \nngười\n \ndùng\n \ncó\n \nthể\n \ndễ\n \ndàng\n \ngiám\n \nsát\n \npipeline,\n \nkiểm\n \ntra\n \nlog,\n \nthực\n \nhiện\n \nretry\n \nhoặc\n \nbackfill,\n \nvà\n \nphát\n \nhiện\n \nlỗi\n \nsớm.\n \nAirflow\n \ncũng\n \nđược\n \nthiết\n \nkế\n \nđể\n \ntích\n \nhợp\n \nsâu\n \nvới\n \ntoàn\n \nbộ\n \nhệ\n \nsinh\n \nthái\n \nBig\n \nData\n \nhiện\n \nđại\n,\n \ntừ\n \ncác\n \ncông\n \ncụ\n \nxử\n \nlý\n \nnhư\n \nApache\n \nSpark,\n \nHadoop,\n \nKafka\n \ncho\n \nđến\n \ncác\n \ndịch\n \nvụ\n \nlưu\n \ntrữ\n \nvà\n \nwarehouse\n \nnhư\n \nAmazon\n \nS3,\n \nGoogle\n \nBigQuery,\n \nSnowflake\n.\n \nNhờ\n \nđó,\n \nAirflow\n \nkhông\n \nchỉ\n \nđơn\n \nthuần\n \nlà\n \nmột\n \ntrình\n \nlập\n \nlịch\n \ncông\n \nviệc,\n \nmà\n \ntrở\n \nthành\n \n“bộ\n \nnão\n \nđiều\n \nphối”\n \ncủa\n \nhệ\n \nthống\n \ndữ\n \nliệu\n \nlớn\n \n—\n \nđảm\n \nbảo\n \nmọi\n \nquy",
  "việc,\n \nmà\n \ntrở\n \nthành\n \n“bộ\n \nnão\n \nđiều\n \nphối”\n \ncủa\n \nhệ\n \nthống\n \ndữ\n \nliệu\n \nlớn\n \n—\n \nđảm\n \nbảo\n \nmọi\n \nquy\n \ntrình\n \nphân\n \ntích,\n \nhọc\n \nmáy,\n \nhay\n \nbáo\n \ncáo\n \nđều\n \nđược\n \ntự\n \nđộng\n \nhóa,\n \ntheo\n \ndõi,\n \nvà\n \nmở\n \nrộng\n \nmột\n \ncách\n \nan\n \ntoàn\n \nvà\n \nhiệu\n \nquả.",
  "Kiến  trúc  tổng  quan  \nScheduler  –  Bộ  lập  lịch  trung  tâm  \nScheduler  là  trái  tim  của  hệ  thống  Airflow ,  chịu  trách  nhiệm  phát  hiện,  lập  lịch  và  kích  hoạt  các  tác  \nvụ\n \n(tasks)\n \ntrong\n \ncác\n \nluồng\n \ncông\n \nviệc\n \n(workflows).\n \nKhi\n \nngười\n \ndùng\n \nđịnh\n \nnghĩa\n \nmột\n \nDAG\n \n(Directed\n \nAcyclic\n \nGraph)\n \n—\n \ntức\n \nlà\n \ntập\n \nhợp\n \ncác\n \ntác\n \nvụ\n \nvà\n \nmối\n \nquan\n \nhệ\n \nphụ\n \nthuộc\n \ngiữa\n \nchúng\n \n—\n \nScheduler\n \nsẽ\n \nquét\n \ncác\n \nfile\n \nDAG\n \nđược\n \nlưu\n \ntrong\n \nthư\n \nmục\n \ncấu\n \nhình,\n \nphân\n \ntích\n \nlogic\n \nphụ\n \nthuộc\n \nvà\n \nxác\n \nđịnh\n \nkhi\n \nnào\n \nmột\n \ntask\n \nđủ\n \nđiều\n \nkiện\n \nđể\n \nchạy.\n \nSau\n \nđó,\n \nScheduler\n \nsẽ\n \nđẩy\n \nyêu\n \ncầu\n \nthực\n \nthi\n \n(task\n \ninstance)\n \ntới\n \nExecutor\n \nđể\n \nbắt\n \nđầu\n \nquá\n \ntrình\n \nxử\n \nlý.\n \nScheduler\n \ncũng\n \nlà\n \nnơi\n \nđiều\n \nphối\n \ncác\n \ncơ\n \nchế\n \nnhư\n \nretry\n \n(chạy\n \nlại\n \ntask\n \nnếu\n \nlỗi)\n,\n \nbackfill\n \n(chạy\n \nlại\n \ndữ\n \nliệu\n \nlịch\n \nsử)\n,\n \nvà\n \ncatchup\n \n(chạy\n \nbù\n \ncác\n \nlịch\n \nbị\n \ntrễ)\n.\n \nNhờ",
  ",\n \nbackfill\n \n(chạy\n \nlại\n \ndữ\n \nliệu\n \nlịch\n \nsử)\n,\n \nvà\n \ncatchup\n \n(chạy\n \nbù\n \ncác\n \nlịch\n \nbị\n \ntrễ)\n.\n \nNhờ\n \ncó\n \nScheduler,\n \nAirflow\n \nđảm\n \nbảo\n \ntoàn\n \nbộ\n \nworkflow\n \nđược\n \nđiều\n \nphối\n \ncó\n \ntrật\n \ntự,\n \nđúng\n \nthời\n \ngian,\n \nvà\n \nkhông\n \nbị\n \nbỏ\n \nsót.\n \nTrong\n \nmôi\n \ntrường\n \nlớn,\n \ncó\n \nthể\n \nchạy\n \nnhiều\n \nScheduler\n \nsong\n \nsong\n \nđể\n \ntăng\n \nkhả\n \nnăng\n \nchịu\n \ntải\n \nvà\n \nđảm\n \nbảo\n \ntính\n \nsẵn\n \nsàng\n \ncao\n \n(High\n \nAvailability).\n \nExecutor  –  Bộ  điều  phối  thực  thi  \nExecutor  là  thành  phần  quyết  định  cách  thức  các  task  được  thực  thi  và  nơi  nào  chúng  sẽ  chạy .  Nó  \nđóng\n \nvai\n \ntrò\n \ntrung\n \ngian\n \ngiữa\n \nScheduler\n \nvà\n \nWorker.\n \nKhi\n \nScheduler\n \nphát\n \nhiện\n \nmột\n \ntask\n \nsẵn\n \nsàng\n \nchạy,\n \nnó\n \nsẽ\n \ngửi\n \nthông\n \ntin\n \ncho\n \nExecutor,\n \nvà\n \nExecutor\n \nsẽ\n \nquyết\n \nđịnh\n \ngửi\n \ntask\n \nđó\n \nđến\n \nWorker\n \nnào\n \nhoặc\n \nchạy\n \ntrực\n \ntiếp\n \n(tùy\n \nloại\n \nExecutor).\n \nAirflow\n \nhỗ\n \ntrợ\n \nnhiều\n \nloại\n \nExecutor\n \nkhác\n \nnhau:",
  "hoặc\n \nchạy\n \ntrực\n \ntiếp\n \n(tùy\n \nloại\n \nExecutor).\n \nAirflow\n \nhỗ\n \ntrợ\n \nnhiều\n \nloại\n \nExecutor\n \nkhác\n \nnhau:\n \nLocalExecutor\n,\n \nCeleryExecutor\n,\n \nKubernetesExecutor\n,...\n \n \n→  Nhờ  Executor,  Airflow  có  thể  mở  rộng  linh  hoạt  (scalable) ,  chạy  từ  vài  task  nhỏ  đến  hàng  nghìn  \ntask\n \ntrên\n \ncụm\n \nmáy\n \nchủ\n \nhoặc\n \nđám\n \nmây.\n \nWorker  –  Nút  xử  lý  tác  vụ  \nWorker  là  nơi  thực  thi  thực  tế  các  công  việc  được  định  nghĩa  trong  DAG.  Khi  nhận  được  task  từ  \nExecutor,\n \nWorker\n \nsẽ\n \ntải\n \ncode\n \nvà\n \nmôi\n \ntrường\n \nliên\n \nquan\n \nđể\n \nthực\n \nthi\n \n—\n \nví\n \ndụ:\n \nchạy\n \nscript\n \nPython,\n \ngửi\n \njob\n \ntới\n \nSpark\n \ncluster,\n \ngọi\n \nAPI,\n \nhoặc\n \ntruy\n \nxuất\n \ndữ\n \nliệu\n \ntừ\n \nkho\n \ndữ\n \nliệu.\n \n \nMỗi\n \nWorker\n \ncó\n \nthể\n \nxử\n \nlý\n \nnhiều\n \ntask\n \nsong\n \nsong\n \n(tùy\n \ncấu\n \nhình\n \ntài\n \nnguyên\n \nCPU\n \nvà\n \nRAM).\n \nSau\n \nkhi\n \ntask\n \nhoàn\n \nthành\n \nhoặc\n \nthất\n \nbại,\n \nWorker\n \nsẽ\n \ngửi\n \ntrạng\n \nthái\n \nkết\n \nquả\n \n(success,\n \nfailed,\n \nretry)\n \ntrở",
  "hoàn\n \nthành\n \nhoặc\n \nthất\n \nbại,\n \nWorker\n \nsẽ\n \ngửi\n \ntrạng\n \nthái\n \nkết\n \nquả\n \n(success,\n \nfailed,\n \nretry)\n \ntrở\n \nlại\n \ncho\n \nMetadata\n \nDatabase\n \nđể\n \ncập\n \nnhật.",
  "Trong  môi  trường  phân  tán,  có  thể  có  hàng  chục  hoặc  hàng  trăm  Worker  hoạt  động  đồng  thời,  giúp  \nAirflow\n \nxử\n \nlý\n \nkhối\n \nlượng\n \nlớn\n \ncông\n \nviệc\n \ncùng\n \nlúc.\n \nViệc\n \ntách\n \nriêng\n \nWorker\n \nkhỏi\n \nScheduler\n \nđảm\n \nbảo\n \ntính\n \nổn\n \nđịnh\n \nvà\n \nchịu\n \nlỗi\n \n—\n \nnếu\n \nmột\n \nWorker\n \nbị\n \nlỗi,\n \nhệ\n \nthống\n \nvẫn\n \nhoạt\n \nđộng\n \nbình\n \nthường\n \nvà\n \ntask\n \ncó\n \nthể\n \nđược\n \ngửi\n \nlại\n \nnode\n \nkhác.\n \nMetadata  Database  –  Bộ  nhớ  trung  tâm  của  hệ  thống  \nMetadata  Database  là  nơi  lưu  trữ  toàn  bộ  thông  tin  vận  hành  của  Airflow .  Nó  ghi  lại  các  dữ  liệu  \nquan\n \ntrọng\n \nnhư:\n \ncấu\n \nhình\n \nDAG,\n \ntrạng\n \nthái\n \ntask\n \n(chạy,\n \nhoàn\n \nthành,\n \nlỗi),\n \nlịch\n \nsử\n \nchạy,\n \nlog,\n \nbiến\n \nmôi\n \ntrường,\n \nvà\n \nthông\n \ntin\n \nngười\n \ndùng.\n \nTất\n \ncả\n \ncác\n \nthành\n \nphần\n \n—\n \nScheduler,\n \nExecutor,\n \nWorker,\n \nvà\n \nWebserver\n \n—\n \nđều\n \nđọc/ghi\n \ndữ\n \nliệu\n \nqua\n \ncơ\n \nsở\n \ndữ\n \nliệu\n \nnày\n,\n \ngiúp\n \nhệ\n \nthống\n \nduy\n \ntrì\n \ntính\n \nnhất\n \nquán",
  "đều\n \nđọc/ghi\n \ndữ\n \nliệu\n \nqua\n \ncơ\n \nsở\n \ndữ\n \nliệu\n \nnày\n,\n \ngiúp\n \nhệ\n \nthống\n \nduy\n \ntrì\n \ntính\n \nnhất\n \nquán\n \n(consistency)\n.\n \nAirflow\n \nthường\n \nsử\n \ndụng\n \nPostgreSQL\n \nhoặc\n \nMySQL\n \ncho\n \nmôi\n \ntrường\n \nsản\n \nxuất,\n \ntrong\n \nkhi\n \nSQLite\n \nchỉ\n \nphù\n \nhợp\n \ncho\n \nthử\n \nnghiệm\n \ncá\n \nnhân.\n \nMetadata\n \nDatabase\n \nlà\n \nđiểm\n \nquan\n \ntrọng\n \nnhất\n \nđể\n \nđồng\n \nbộ\n \nhóa\n \ngiữa\n \ncác\n \nthành\n \nphần,\n \ndo\n \nđó\n \ncần\n \nđược\n \ncấu\n \nhình\n \ntối\n \nưu\n \n(connection\n \npooling,\n \nindexing,\n \nbackup\n \nđịnh\n \nkỳ)\n \nđể\n \ntránh\n \nnghẽn\n \ncổ\n \nchai\n \nkhi\n \nchạy\n \nở\n \nquy\n \nmô\n \nlớn.\n \nWeb  UI  –  Giao  diện  quản  lý  và  giám  sát  \nWeb  UI  là  giao  diện  trực  quan  giúp  người  dùng  tương  tác  với  Airflow.  Thông  qua  Web  UI,  kỹ  sư  dữ  liệu  \ncó\n \nthể:",
  "có\n \nthể:\n \n●  Theo  dõi  DAGs  đang  chạy ,  xem  trạng  thái  của  từng  task  (success/failed/running).  ●  Truy  cập  log  chi  tiết  của  mỗi  task  để  debug  khi  có  lỗi.  ●  Kích  hoạt,  tạm  dừng,  hoặc  chạy  lại  các  DAG  thủ  công.  ●  Quan  sát  phụ  thuộc  giữa  các  task  thông  qua  biểu  đồ  DAG.  ●  Xem  thống  kê,  lịch  sử  chạy,  và  thông  tin  hệ  thống  (scheduler,  queue,  worker).  \nGiao  diện  này  chạy  trên  nền  tảng  Flask  và  lấy  dữ  liệu  từ  Metadata  Database,  giúp  hiển  thị  tình  trạng  \nhoạt\n \nđộng\n \ncủa\n \ntoàn\n \nhệ\n \nthống\n \ntheo\n \nthời\n \ngian\n \nthực.\n \nNgoài\n \nra,\n \nAirflow\n \ncòn\n \ncung\n \ncấp\n \nREST\n \nAPI\n \nđể\n \ntự\n \nđộng\n \nhóa\n \nvà\n \ntích\n \nhợp\n \nvới\n \ncác\n \ncông\n \ncụ\n \ngiám\n \nsát\n \nhoặc\n \nDevOps\n \nkhác.\n \nLuồng  hoạt  động  của  Airflow  \nLuồng  hoạt  động  (Workflow  Lifecycle)  trong  Airflow  diễn  ra  theo  các  bước  tuần  tự:",
  "Luồng  hoạt  động  (Workflow  Lifecycle)  trong  Airflow  diễn  ra  theo  các  bước  tuần  tự:  \n1.  Kỹ  sư  dữ  liệu  định  nghĩa  DAG  bằng  Python,  bao  gồm  các  task  và  dependencies  giữa  chúng.  2.  Scheduler  quét  DAGs ,  xác  định  những  task  nào  sẵn  sàng  chạy  (theo  lịch  hoặc  phụ  thuộc).  3.  Executor  gửi  các  task  đến  hàng  đợi  thông  điệp  (nếu  dùng  Celery/Kubernetes)  hoặc  trực  tiếp  \nđến\n \nWorker.\n 4.  Worker  nhận  và  thực  thi  task ,  ví  dụ:  gọi  Spark  job,  tải  dữ  liệu  từ  API,  hoặc  ghi  vào  database.  5.  Sau  khi  hoàn  thành,  Worker  ghi  lại  trạng  thái  của  task  vào  Metadata  Database.  6.  Webserver  đọc  dữ  liệu  từ  database  và  hiển  thị  trạng  thái  cập  nhật  trên  Web  UI.  \nToàn  bộ  chu  trình  này  diễn  ra  liên  tục  và  tự  động,  đảm  bảo  hàng  trăm  pipeline  có  thể  được  lập  lịch  và  \ngiám\n \nsát\n \nsong\n \nsong\n \nmà\n \nkhông\n \ncần\n \ncan\n \nthiệp\n \nthủ\n \ncông.",
  "Kiến  trúc  phân  tán  (Distributed  Architecture)  \n \nAirflow  được  thiết  kế  theo  mô  hình  phân  tán  (distributed) ,  tách  biệt  giữa  lập  lịch  (Scheduler)  và  thực  \nthi\n \n(Workers)\n.\n \nTrong\n \nmột\n \ntriển\n \nkhai\n \nproduction\n \nđiển\n \nhình,\n \ncác\n \nthành\n \nphần\n \ncó\n \nthể\n \nnằm\n \ntrên\n \ncác\n \nmáy\n \nchủ\n \nriêng\n \nbiệt:\n \n●  Node  A:  Scheduler  ●  Node  B:  Webserver  ●  Node  C:  Metadata  Database  ●  Node  D:  Message  Broker  (Redis/RabbitMQ)  ●  Nhiều  Node  khác:  Workers  (xử  lý  task  song  song)  \nEdge  Worker  trong  Apache  Airflow  là  một  node  worker  “phân  tán”  được  triển  khai  tại  vị  trí  biên  (edge  \nsite)\n,\n \ncho\n \nphép\n \nthực\n \nthi\n \ncác\n \ntác\n \nvụ\n \nngay\n \ngần\n \nnguồn\n \ndữ\n \nliệu\n \nthay\n \nvì\n \ntại\n \ntrung\n \ntâm\n \ndữ\n \nliệu\n \nchính.\n \nNó\n \nkết\n \nnối\n \nvới\n \ncluster\n \ntrung\n \ntâm\n \nqua\n \nHTTP(S)\n \nmà\n \nkhông\n \ncần\n \nmessage\n \nbroker,\n \ngiúp\n \nvượt\n \nqua\n \ncác\n \nrào\n \ncản\n \nmạng\n \nnhư\n \nfirewall\n \nhoặc\n \nNAT.\n \nTrong\n \nkiến\n \ntrúc\n \nphân\n \ntán,",
  "giúp\n \nvượt\n \nqua\n \ncác\n \nrào\n \ncản\n \nmạng\n \nnhư\n \nfirewall\n \nhoặc\n \nNAT.\n \nTrong\n \nkiến\n \ntrúc\n \nphân\n \ntán,\n \nEdge\n \nWorker\n \nmở\n \nrộng\n \nkhả\n \nnăng\n \nxử\n \nlý\n \ncủa\n \nAirflow\n \nbằng\n \ncách\n \ncho\n \nphép\n \nchạy\n \ntask\n \nở\n \nnhiều\n \nđịa\n \nđiểm\n \nkhác\n \nnhau\n,\n \nđặc\n \nbiệt\n \ntrong\n \nmôi\n \ntrường\n \nmulti-site\n \nhoặc\n \nremote\n \ndata\n \ncenter\n.\n \nViệc\n \nnày\n \ngiúp\n \ngiảm\n \nđộ\n \ntrễ,\n \ngiảm\n \ntải\n \ntruyền\n \ndữ\n \nliệu\n \nqua\n \nWAN\n,\n \nvà\n \ntăng\n \nhiệu\n \nsuất\n \ntổng\n \nthể.\n \nHệ\n \nthống\n \ncó\n \nthể\n \nphối\n \nhợp\n \nnhiều\n \nexecutor\n \n(Celery,\n \nKubernetes,\n \nEdgeExecutor)\n \nđể\n \nchạy\n \ntask\n \nlinh\n \nhoạt.\n \nCác\n \nEdge\n \nWorker\n \nvẫn\n \nđược\n \nquản\n \nlý\n \ntập\n \ntrung\n,\n \ngửi\n \nheartbeat,\n \nlog\n \nvà\n \ntrạng\n \nthái\n \nvề\n \nAPI\n \nserver,\n \nđảm\n \nbảo\n \nquan\n \nsát\n \nthống\n \nnhất.\n \nLuồng\n \nhoạt\n \nđộng\n \ngồm:\n \nScheduler\n \ngửi\n \ntask\n \nđến\n \nhàng\n \nđợi\n \nedge\n \n→\n \nEdge\n \nWorker\n \nlấy\n \ntask\n \nqua\n \nHTTP\n \n→\n \nxử\n \nlý\n \ntại\n \nchỗ\n \n→\n \ntrả\n \nkết\n \nquả\n \nvề\n \ntrung\n \ntâm\n \nđể\n \nhiển\n \nthị\n \ntrên\n \ngiao",
  "task\n \nqua\n \nHTTP\n \n→\n \nxử\n \nlý\n \ntại\n \nchỗ\n \n→\n \ntrả\n \nkết\n \nquả\n \nvề\n \ntrung\n \ntâm\n \nđể\n \nhiển\n \nthị\n \ntrên\n \ngiao\n \ndiện\n \nAirflow.\n \nMô  hình  này  giúp  hệ  thống  mở  rộng  linh  hoạt  (scalable)  và  chịu  lỗi  tốt  (fault-tolerant) .  Khi  khối  lượng  \ncông\n \nviệc\n \ntăng,\n \nta\n \nchỉ\n \ncần\n \nthêm\n \nWorker;\n \nkhi\n \ncần\n \nđộ\n \ntin\n \ncậy\n \ncao\n \nhơn,\n \ncó\n \nthể\n \ntriển\n \nkhai\n \nnhiều\n \nScheduler\n \nhoặc\n \ndùng\n \nKubernetesExecutor\n \nđể\n \nmỗi\n \ntask\n \ntự\n \nsinh\n \nPod\n \nriêng\n \nbiệt.\n \nNhờ\n \ncấu\n \ntrúc\n \nnày,\n \nAirflow\n \nhoạt\n \nđộng\n \nhiệu\n \nquả\n \ntrong\n \nmôi\n \ntrường\n \nBig\n \nData\n \n–\n \nnơi\n \ncó\n \nhàng\n \nnghìn\n \ntask,\n \ndữ\n \nliệu\n \nlớn,\n \nvà\n \nnhiều\n \npipeline\n \nphức\n \ntạp\n \ncần\n \nđược\n \nđiều\n \nphối\n \nchính\n \nxác.",
  "Hạn  chế  của  kiến  trúc  Airflow  \nMặc  dù  mạnh  mẽ,  kiến  trúc  Airflow  vẫn  có  một  số  hạn  chế  đáng  chú  ý :  \n●  Không  phù  hợp  cho  xử  lý  real-time  (thời  gian  thực) :  Airflow  được  thiết  kế  cho  batch  \nprocessing\n \n(xử\n \nlý\n \ntheo\n \nlô),\n \nnên\n \nkhông\n \ntối\n \nưu\n \ncho\n \ndữ\n \nliệu\n \nstreaming\n \ncó\n \nđộ\n \ntrễ\n \nthấp\n \nnhư\n \nKafka\n \nhoặc\n \nFlink.\n ●  Độ  phức  tạp  trong  triển  khai :  Khi  hệ  thống  lớn,  việc  quản  lý  nhiều  node  (Scheduler,  Worker,  \nDatabase,\n \nBroker)\n \ntrở\n \nnên\n \nkhó\n \nkhăn;\n \ncần\n \nkỹ\n \nnăng\n \nDevOps\n \ntốt\n \nđể\n \nvận\n \nhành\n \nổn\n \nđịnh.\n ●  Phụ  thuộc  vào  cơ  sở  dữ  liệu  trung  tâm :  Nếu  Metadata  Database  bị  nghẽn  hoặc  lỗi,  toàn  bộ  \nAirflow\n \ncó\n \nthể\n \nbị\n \nảnh\n \nhưởng.\n ●  Không  tối  ưu  cho  workflow  quá  nhỏ  hoặc  thay  đổi  liên  tục ,  vì  việc  parse  và  schedule  DAG  \ntốn\n \nchi\n \nphí\n \nnhất\n \nđịnh.\n \nDAG  (Directed  Acyclic  Graph)  \nKhái  niệm  DAG  trong  Airflow",
  "tốn\n \nchi\n \nphí\n \nnhất\n \nđịnh.\n \nDAG  (Directed  Acyclic  Graph)  \nKhái  niệm  DAG  trong  Airflow  \nTrong  Apache  Airflow,  DAG  (Directed  Acyclic  Graph)  là  trái  tim  của  hệ  thống ,  dùng  để  mô  tả  một  \nworkflow\n \n(luồng\n \ncông\n \nviệc)\n \ngồm\n \nnhiều\n \ntác\n \nvụ\n \n(tasks)\n \nvà\n \nmối\n \nquan\n \nhệ\n \ngiữa\n \nchúng.\n \nDAG\n \ncho\n \nbiết\n \nnhững\n \ntác\n \nvụ\n \nnào\n \ncần\n \nchạy,\n \nkhi\n \nnào\n \nchạy,\n \nvà\n \ntheo\n \nthứ\n \ntự\n \nnào\n.\n \n“Directed”\n \nnghĩa\n \nlà\n \ncác\n \ntác\n \nvụ\n \ncó\n \nhướng\n \nthực\n \nthi\n \nrõ\n \nràng\n \n(task\n \nA\n \nchạy\n \ntrước\n \ntask\n \nB).\n \nMột\n \nđường\n \ndẫn\n \n(path)\n \nlà\n \nmột\n \nchuỗi\n \ncác\n \nnút\n \nđược\n \nkết\n \nnối\n \nbởi\n \ncác\n \ncạnh\n \ncó\n \nhướng,\n \nbắt\n \nđầu\n \ntừ\n \nmột\n \nnút\n \ncụ\n \nthể\n \nvà\n \ntheo\n \nhướng\n \ncủa\n \ncác\n \ncạnh\n \nđể\n \nđến\n \nmột\n \nnút\n \nkhác.\n \nĐường\n \ndẫn\n \ncó\n \nthể\n \ncó\n \nđộ\n \ndài\n \nbất\n \nkỳ,\n \ntừ\n \nmột\n \nnút\n \nđơn\n \nlẻ\n \nđến\n \nmột\n \nchuỗi\n \nnhiều\n \nnút,\n \nmiễn\n \nlà\n \nluôn\n \ntuân\n \ntheo\n \nhướng\n \ncủa\n \ncác\n \ncạnh.\n \n“Acyclic”\n \nnghĩa\n \nlà\n \nkhông\n \ntồn\n \ntại",
  "nút,\n \nmiễn\n \nlà\n \nluôn\n \ntuân\n \ntheo\n \nhướng\n \ncủa\n \ncác\n \ncạnh.\n \n“Acyclic”\n \nnghĩa\n \nlà\n \nkhông\n \ntồn\n \ntại\n \nvòng\n \nlặp\n \n—\n \nmột\n \ntask\n \nkhông\n \nthể\n \nphụ\n \nthuộc\n \nngược\n \nlại\n \nchính\n \nnó.\n \nĐiều\n \nnày\n \nđảm\n \nbảo\n \nrằng\n \nmỗi\n \nworkflow\n \ncó\n \nđiểm\n \nbắt\n \nđầu\n \nvà\n \nkết\n \nthúc\n \nxác\n \nđịnh,\n \ntránh\n \ncác\n \nvòng\n \nlặp\n \nvô\n \nhạn\n \ntrong\n \nxử\n \nlý.\n \nVề\n \nbản\n \nchất,\n \nDAG\n \ntrong\n \nAirflow\n \nlà\n \nmột\n \nđồ\n \nthị\n \ncó\n \nhướng\n \nvà\n \nkhông\n \nchu\n \ntrình\n,\n \nđược\n \nđịnh\n \nnghĩa\n \nbằng\n \nmã\n \nPython\n,\n \ncho\n \nphép\n \nngười\n \ndùng\n \nbiểu\n \ndiễn\n \nvà\n \nđiều\n \nkhiển\n \nluồng\n \nxử\n \nlý\n \ndữ\n \nliệu\n \nmột\n \ncách\n \nlinh\n \nhoạt,\n \ncó\n \nthể\n \nkiểm\n \nthử,\n \nvà\n \ndễ\n \ndàng\n \nquản\n \nlý\n \nphiên\n \nbản\n \n(version\n \ncontrol).\n \nVai  trò  trung  tâm  của  DAG  trong  Airflow  \nDAG  được  xem  là  trung  tâm  của  kiến  trúc  Airflow  vì  nó  chính  là  “ngôn  ngữ  chung”  để  mô  tả,  lập  lịch,  \nvà\n \nđiều\n \nphối\n \ncác\n \nluồng\n \ncông\n \nviệc.\n \nThay\n \nvì\n \nphải\n \nchạy\n \nthủ\n \ncông\n \ncác\n \nscript",
  "và\n \nđiều\n \nphối\n \ncác\n \nluồng\n \ncông\n \nviệc.\n \nThay\n \nvì\n \nphải\n \nchạy\n \nthủ\n \ncông\n \ncác\n \nscript\n \nETL\n \nhay\n \nxử\n \nlý\n \ndữ\n \nliệu\n \nrời\n \nrạc,\n \nngười\n \ndùng\n \ncó\n \nthể\n \nmô\n \nhình\n \nhóa\n \ntoàn\n \nbộ\n \npipeline\n \ntrong\n \nmột\n \nDAG\n \nduy\n \nnhất.\n \nCách\n \ntiếp\n \ncận\n \n“workflow\n \nas\n \ncode”\n \ngiúp\n \nmang\n \ntính\n \nlinh\n \nhoạt\n \ncủa\n \nlập\n \ntrình\n \nvào\n \nviệc\n \nthiết\n \nkế\n \npipeline:\n \nbạn\n \ncó\n \nthể\n \nkiểm\n \nthử\n \nDAG,\n \nđưa\n \nvào\n \nhệ\n \nthống\n \nquản\n \nlý\n \nphiên\n \nbản\n \nGit,\n \nvà\n \ntự\n \nđộng\n \ntriển\n \nkhai\n \n(CI/CD).\n \nDAG\n \ncũng\n \ngiúp\n \ntách\n \nbiệt\n \ngiữa\n \nlogic\n \nđiều\n \nphối\n \n(orchestration)\n \nvà\n \nthực\n \nthi\n \n(execution)\n \n—\n \nDAG\n \nchỉ\n \nđịnh\n \nnhững\n \ngì\n \ncần\n \nlàm\n \nvà\n \nkhi\n \nnào,\n \ncòn",
  "Executor  và  Worker  chịu  trách  nhiệm  chạy  chúng.  Bằng  cách  này,  Airflow  có  thể  mở  rộng  quy  mô  linh  \nhoạt,\n \nquản\n \nlý\n \nsong\n \nsong\n \nhàng\n \ntrăm\n \npipeline\n \nkhác\n \nnhau.\n \nNgoài\n \nra,\n \nDAG\n \ncòn\n \ngiúp\n \nhiển\n \nthị\n \ntoàn\n \nbộ\n \ncấu\n \ntrúc\n \nworkflow\n \ntrên\n \ngiao\n \ndiện\n \nWeb\n \nUI,\n \ngiúp\n \nnhóm\n \nkỹ\n \nsư\n \ndữ\n \nliệu\n \ntheo\n \ndõi,\n \nquản\n \nlý,\n \nvà\n \nkhắc\n \nphục\n \nsự\n \ncố\n \ndễ\n \ndàng\n \ntrong\n \nhệ\n \nthống\n \nBig\n \nData\n \nphức\n \ntạp.\n \nMột  DAG  trong  Airflow  gồm  nhiều  thành  phần  cấu  trúc  cốt  lõi.  Đầu  tiên  là  DAG  object ,  được  khai  báo  \ntrong\n \nmã\n \nPython\n \nvới\n \ncác\n \ntham\n \nsố\n \nnhư\n dag_id (định  danh  DAG),  start_date (ngày  bắt  đầu),  schedule (chu  kỳ  chạy),  default_args (các  tham  số  mặc  định  cho  tasks),  và  catchup (xác  định  có  \nchạy\n \nbù\n \nnhững\n \nlần\n \nbị\n \nbỏ\n \nlỡ\n \nhay\n \nkhông).\n \nNgoài\n \nra,\n \nDAG\n \ncòn\n \ncó\n \ncác\n \nthuộc\n \ntính\n \nđiều\n \nkhiển\n \nnhư",
  "những\n \nlần\n \nbị\n \nbỏ\n \nlỡ\n \nhay\n \nkhông).\n \nNgoài\n \nra,\n \nDAG\n \ncòn\n \ncó\n \ncác\n \nthuộc\n \ntính\n \nđiều\n \nkhiển\n \nnhư\n max_active_runs,  tags,  retry_delay,  hoặc  callback  khi  task  thất  bại.  Khi  được  Scheduler  quét,  \nDAG\n \nsẽ\n \nđược\n \nphân\n \ntích\n \nđể\n \nbiết\n \nthứ\n \ntự\n \nchạy,\n \nlịch\n \ntrình\n \nvà\n \nđiều\n \nkiện\n \nphụ\n \nthuộc\n \ngiữa\n \ncác\n \ntác\n \nvụ.\n \nTasks  /  Operators  trong  Airflow  \nTrong  Airflow,  Task  là  đơn  vị  công  việc  nhỏ  nhất  trong  một  DAG  —  mỗi  task  đại  diện  cho  một  hành  \nđộng\n \ncụ\n \nthể\n \ncần\n \nđược\n \nthực\n \nthi,\n \nví\n \ndụ\n \nnhư\n \nchạy\n \nmột\n \nđoạn\n \nmã\n \nPython,\n \ntải\n \ndữ\n \nliệu\n \ntừ\n \nAPI,\n \nnạp\n \ndữ\n \nliệu\n \nvào\n \ncơ\n \nsở\n \ndữ\n \nliệu,\n \nhay\n \nkhởi\n \nchạy\n \nmột\n \njob\n \ntrên\n \nSpark\n \nhoặc\n \nHadoop.\n \nVề\n \nbản\n \nchất,\n \nTasks\n \nđược\n \ntạo\n \nra\n \ntừ\n \ncác\n \nOperators\n,\n \ntức\n \nlà\n \nmẫu\n \n(template)\n \nđịnh\n \nnghĩa\n \nloại\n \ncông\n \nviệc\n \ncần\n \nthực\n \nhiện\n.\n \nNói\n \ncách\n \nkhác,\n \nmột\n \nOperator\n \nchính\n \nlà\n \n“class”\n \ncòn\n \nTask\n \nlà",
  "công\n \nviệc\n \ncần\n \nthực\n \nhiện\n.\n \nNói\n \ncách\n \nkhác,\n \nmột\n \nOperator\n \nchính\n \nlà\n \n“class”\n \ncòn\n \nTask\n \nlà\n \n“instance”\n \nđược\n \nsử\n \ndụng\n \ntrong\n \nDAG.\n \nAirflow  cung  cấp  nhiều  loại  Operator  khác  nhau,  được  chia  theo  mục  đích  sử  dụng:  \nNhóm  Ví  dụ  Chức  năng  \nCore  Operators  \nPythonOperator,  BashOperator,  EmailOperator \nThực  thi  script  Python,  command  shell,  gửi  email,  v.v.  \nTransfer  Operators  \nS3ToRedshiftOperator,  MySqlToGCSOperator \nDi  chuyển  dữ  liệu  giữa  các  nó  hệ  thống.  \nAction  Operators  \nSparkSubmitOperator,  DockerOperator,  KubernetesPodOperator \nChạy  job  xử  lý  dữ  liệu  hoặc  container  trên  các  nền  tảng  khác  nhau.  \nSensor  Operators  \nFileSensor,  ExternalTaskSensor \nChờ  đợi  một  điều  kiện  xảy  ra  (ví  dụ:  file  xuất  hiện,  task  khác  hoàn  tất).",
  "Custom  Operators  \nNgười  dùng  tự  định  nghĩa  subclass  Operator  riêng  \nDùng  cho  logic  nghiệp  vụ  cụ  thể  hoặc  tích  hợp  hệ  thống  nội  bộ.  \nVí  dụ,  một  task  dùng  PythonOperator  có  thể  được  định  nghĩa  như  sau:  \nfrom  airflow.operators.python  import  PythonOperator  \ndef  transform_data():  \nprint(\"Transforming  data...\")  \ntransform_task  =  PythonOperator(  \ntask_id='transform_data',  \n     python_callable=transform_data)  \n \nỞ  đây,  transform_task là  Task  Instance  của  Operator  PythonOperator.  Mỗi  Task  có  các  thuộc  \ntính\n \nquan\n \ntrọng\n \nnhư:\n \n●  task_id:  định  danh  duy  nhất  trong  DAG.  ●  python_callable (hoặc  bash_command…):  hành  động  cần  thực  thi.  ●  retries,  retry_delay:  cấu  hình  retry  khi  task  lỗi.  ●  depends_on_past:  quy  định  task  có  cần  chờ  phiên  bản  trước  của  chính  nó  hoàn  tất  không.",
  "Khi  Scheduler  kích  hoạt  một  DAG  Run,  Airflow  sẽ  tạo  ra  các  Task  Instance ,  mỗi  instance  đại  diện  cho  \nmột\n \nlần\n \nchạy\n \ncủa\n \ntask\n \ntương\n \nứng\n \ntại\n \nthời\n \nđiểm\n \nđó.\n \nCác\n \ntask\n \nnày\n \nđược\n \ngửi\n \nđến\n \nExecutor\n \n→\n \nWorker\n \nđể\n \nthực\n \nthi,\n \nvà\n \nkết\n \nquả\n \n(thành\n \ncông,\n \nthất\n \nbại,\n \nđang\n \nchạy…)\n \nđược\n \ncập\n \nnhật\n \ntrong\n \nMetadata\n \nDatabase.\n \nVòng  đời  của  một  task  \n \nBan  đầu,  một  task  mới  được  tạo  ra  có  trạng  thái  “No  status” ,  sau  đó  Scheduler  sẽ  quét  DAG  và  \nchuyển\n \nnó\n \nsang\n \ntrạng\n \nthái\n \n“Scheduled”\n \nkhi\n \nđến\n \nthời\n \nđiểm\n \nchạy\n \nhoặc\n \nkhi\n \ncác\n \nđiều\n \nkiện\n \nphụ\n \nthuộc\n \nđã\n \nđược\n \nthỏa\n \nmãn.\n \nTại\n \nđây,\n \ntask\n \ncó\n \nthể\n \nbị\n \n“Removed”\n \nnếu\n \nDAG\n \nbị\n \nthay\n \nđổi,\n \nhoặc\n \nbị\n \nđánh\n \ndấu\n \n“Upstream",
  "failed”  nếu  một  task  phụ  thuộc  trước  đó  thất  bại.  Khi  Scheduler  gửi  task  đến  Executor ,  nó  được  chuyển  \nsang\n \ntrạng\n \nthái\n \n“Queued”\n,\n \nnghĩa\n \nlà\n \nđang\n \nchờ\n \nmột\n \nWorker\n \ncó\n \nsẵn\n \nđể\n \nxử\n \nlý.\n \nKhi  Worker  nhận  task  và  bắt  đầu  thực  thi,  trạng  thái  chuyển  sang  “Running” .  Nếu  task  hoàn  thành  \nthành\n \ncông,\n \nnó\n \nđược\n \nđánh\n \ndấu\n \nlà\n \n“Success”\n;\n \nnếu\n \ncó\n \nlỗi\n \ntrong\n \nquá\n \ntrình\n \nthực\n \nthi,\n \ntask\n \nchuyển\n \nsang\n \n“Failed”\n.\n \nTrong\n \ntrường\n \nhợp\n \ncó\n \ncấu\n \nhình\n retries,  task  sẽ  chuyển  sang  trạng  thái  “Up  for  retry”  và  \nquay\n \nlại\n \nhàng\n \nđợi\n \nđể\n \nchạy\n \nlại.\n \nSau\n \nkhi\n \nretry\n \nhết\n \nsố\n \nlần\n \ncho\n \nphép\n \nmà\n \nvẫn\n \nlỗi,\n \ntask\n \nsẽ\n \ngiữ\n \ntrạng\n \nthái\n \n“Failed”\n \ncuối\n \ncùng.\n \nDependencies  (Quan  hệ  phụ  thuộc  giữa  các  Task)  \nTrong  một  DAG,  Dependencies  (sự  phụ  thuộc)  là  yếu  tố  xác  định  thứ  tự  thực  thi  các  task .  Chúng  \nđảm\n \nbảo\n \nrằng\n \ncác\n \ncông\n \nviệc\n \nđược\n \nthực",
  "đảm\n \nbảo\n \nrằng\n \ncác\n \ncông\n \nviệc\n \nđược\n \nthực\n \nhiện\n \nđúng\n \nlogic\n \n—\n \nví\n \ndụ,\n \nbạn\n \nphải\n \n“extract\n \ndữ\n \nliệu”\n \nxong\n \nmới\n \ncó\n \nthể\n \n“transform”,\n \nrồi\n \nmới\n \n“load”\n \nvào\n \nkho\n \ndữ\n \nliệu.\n \nAirflow\n \ncho\n \nphép\n \nđịnh\n \nnghĩa\n \ndependencies\n \ngiữa\n \ncác\n \ntask\n \nmột\n \ncách\n \nlinh\n \nhoạt,\n \nthông\n \nqua\n \ntoán\n \ntử\n \nhướng\n \n(>> và  <<)  hoặc  các  hàm  set_upstream()  /  set_downstream() .  \nVí  dụ:  \nextract  >>  transform  >>  load  \nCâu  lệnh  trên  tương  đương  với:  \ntransform.set_upstream(extract)  load.set_upstream(transform)  \nDependencies  trong  Airflow  không  chỉ  giúp  đảm  bảo  tính  logic  của  pipeline  mà  còn  giúp  tận  dụng  \nsong\n \nsong\n \nhóa\n:\n \ncác\n \ntask\n \nkhông\n \nphụ\n \nthuộc\n \nnhau\n \ncó\n \nthể\n \nchạy\n \nđồng\n \nthời\n \ntrên\n \ncác\n \nworker\n \nkhác\n \nnhau,\n \ngiúp\n \ntối\n \nưu\n \nthời\n \ngian\n \nxử\n \nlý.\n \nCách  vận  hành  và  ví  dụ  minh  họa  của  DAG",
  "worker\n \nkhác\n \nnhau,\n \ngiúp\n \ntối\n \nưu\n \nthời\n \ngian\n \nxử\n \nlý.\n \nCách  vận  hành  và  ví  dụ  minh  họa  của  DAG  \nMột  ví  dụ  đơn  giản  giúp  hình  dung  rõ  cách  DAG  hoạt  động  là  pipeline  ETL  (Extract–Transform–Load).  \nwith  DAG(  dag_id='etl_pipeline',   start_date=datetime(2025,10,1),   schedule_interval='@daily'  )  as  dag:       extract  =  BashOperator(  task_id='extract',   bash_command='python  extract.py'  )       transform  =  BashOperator(  task_id='transform',   bash_command='python  transform.py'  )       load  =  BashOperator(  task_id='load',   bash_command='python  load.py')       extract  >>  transform  >>  load",
  "Trong  ví  dụ  này,  DAG  có  ba  tác  vụ:  extract,  transform,  và  load.  Khi  đến  thời  điểm  được  định  trong  schedule_interval,  Airflow  Scheduler  sẽ  tạo  ra  một  DAG  Run  tương  ứng.  Scheduler  kiểm  tra  \ndependencies\n \nvà\n \ngửi\n \ntask\n extract đến  Executor ,  task  được  thực  thi  bởi  Worker .  Sau  khi  extract \nhoàn\n \nthành\n \nthành\n \ncông,\n transform mới  được  kích  hoạt,  và  cuối  cùng  load được  thực  hiện  để  kết  thúc  \npipeline.\n \nToàn\n \nbộ\n \ntrạng\n \nthái\n \nchạy,\n \nlog,\n \nvà\n \nkết\n \nquả\n \nđược\n \nlưu\n \nvào\n \nMetadata\n \nDatabase\n \nvà\n \nhiển\n \nthị\n \ntrong\n \nAirflow\n \nWeb\n \nUI\n \ndưới\n \ndạng\n \nđồ\n \nthị\n \ntrực\n \nquan.\n \nQuy\n \ntrình\n \nnày\n \ngiúp\n \nngười\n \nvận\n \nhành\n \ndễ\n \ndàng\n \ngiám\n \nsát,\n \nkiểm\n \ntra\n \nlỗi,\n \nvà\n \nđảm\n \nbảo\n \nluồng\n \nxử\n \nlý\n \ndữ\n \nliệu\n \nhoạt\n \nđộng\n \nđúng\n \nthứ\n \ntự\n \nvà\n \nổn\n \nđịnh.\n  \n \nAirflow  trong  hệ  thống  phân  tán",
  "xử\n \nlý\n \ndữ\n \nliệu\n \nhoạt\n \nđộng\n \nđúng\n \nthứ\n \ntự\n \nvà\n \nổn\n \nđịnh.\n  \n \nAirflow  trong  hệ  thống  phân  tán  \nKhi  triển  khai  trong  hệ  thống  phân  tán,  Airflow  không  chỉ  chạy  trên  một  máy  duy  nhất  mà  có  thể  hoạt  \nđộng\n \ntrên\n \nnhiều\n \nnode\n \nhoặc\n \ncontainer\n \nkhác\n \nnhau.\n \nCách\n \nlàm\n \nnày\n \ngiúp\n \ntăng\n \nhiệu\n \nnăng\n \n(chạy\n \nsong\n \nsong\n \nnhiều\n \ntác\n \nvụ),\n \ntăng\n \nđộ\n \ntin\n \ncậy\n \n(nếu\n \nmột\n \nnode\n \nhỏng,\n \nhệ\n \nthống\n \nvẫn\n \nhoạt\n \nđộng),\n \nvà\n \nđặc\n \nbiệt\n \nlà\n \nkhả\n \nnăng\n \nmở\n \nrộng\n \nquy\n \nmô\n \nkhi\n \nkhối\n \nlượng\n \ncông\n \nviệc\n \ntăng.\n \nMức\n \nđộ\n \nphân\n \ntán\n \ncủa\n \nAirflow\n \nphụ\n \nthuộc\n \nvào\n \nExecutor\n \nmà\n \nta\n \nlựa\n \nchọn\n \ntrong\n \ncấu\n \nhình.\n \nCác\n \nExecutor\n \nkhác\n \nnhau\n \nsẽ\n \nquyết\n \nđịnh\n \ncách\n \ntask\n \nđược\n \ngửi\n \nđi\n \nvà\n \nthực\n \nthi\n \nở\n \nđâu.\n \nLocalExecutor  \n LocalExecutor  là  một  loại  executor  trong  đó  các  task  được  chạy  ngay  trên  cùng  một  máy  (node)  với  \nScheduler,\n \nthay\n \nvì\n \ngửi\n \nđi\n \ncho\n \ncác\n \nworker",
  "Scheduler,\n \nthay\n \nvì\n \ngửi\n \nđi\n \ncho\n \ncác\n \nworker\n \ntừ\n \nxa.\n \nLocalExecutor\n \nthường\n \nđược\n \nsử\n \ndụng\n \ntrong\n \nmôi\n \ntrường\n \nphát\n \ntriển\n \n(development)\n \nhoặc\n \nsản\n \nxuất\n \nnhỏ\n \n(small-scale\n \nproduction)\n.\n \nNó\n \nthích\n \nhợp\n \ncho\n \ncác\n \nhệ\n \nthống\n \ncó\n \nlượng\n \ntác\n \nvụ\n \nvừa\n \nphải,\n \ncần\n \nchạy\n \nsong\n \nsong\n \nnhưng\n \nkhông\n \ncần\n \nphân\n \ntán\n \ntrên\n \nnhiều\n \nmáy.\n \nƯu\n \nđiểm\n \nlớn\n \nnhất\n \ncủa\n \nLocalExecutor\n \nlà\n \nthiết\n \nlập\n \ndễ\n \ndàng:\n \nchỉ\n \ncần\n \nthay\n \nđổi\n \ncấu\n \nhình\n executor  =  \nLocalExecutor trong  file  airflow.cfg và  bảo  đảm  sử  dụng  cơ  sở  dữ  liệu  thực  (PostgreSQL  hoặc  \nMySQL).\n \nVì\n \nSQLite\n \nkhông\n \nhỗ\n \ntrợ\n \ntruy\n \ncập\n \nđồng\n \nthời\n \nnhiều\n \nprocess,\n \nnên\n \nkhông\n \nthể\n \ndùng\n \ncho\n \nLocalExecutor.\n  \nScheduler\n \ncủa\n \nAirflow\n \nchịu\n \ntrách\n \nnhiệm\n \nlên\n \nlịch\n \ncác\n \ntask,\n \ncập\n \nnhật\n \ntrạng\n \nthái\n \ncủa\n \nchúng\n \nvào\n \nmetadata\n \ndatabase\n \n.\n \nKhi\n \nmột\n \ntask\n \nđến\n \nlượt\n \nthực\n \nthi,\n \nScheduler\n \ngửi\n \nlệnh",
  "của\n \nchúng\n \nvào\n \nmetadata\n \ndatabase\n \n.\n \nKhi\n \nmột\n \ntask\n \nđến\n \nlượt\n \nthực\n \nthi,\n \nScheduler\n \ngửi\n \nlệnh\n execute_async(key,  \ncommand) cho  LocalExecutor.  Executor  sau  đó  tạo  process  tương  ứng  để  chạy  task  hoặc  đưa  task  vào  \nhàng\n \nđợi.\n \nTrong\n \nquá\n \ntrình\n \nchạy,\n \nScheduler\n \nđịnh\n \nkỳ\n \ngửi\n \n“heartbeat”\n \nđể\n \nđồng\n \nbộ\n \ntrạng\n \nthái,\n \nđảm\n \nbảo\n \ncác\n \ntask\n \nhoàn\n \nthành\n \nđược\n \ncập\n \nnhật\n \nvề\n \ndatabase.\n \nVì\n \ntất\n \ncả\n \nhoạt\n \nđộng\n \ndiễn\n \nra\n \ntrong\n \ncùng\n \nmột\n \nnode,\n \nnên",
  "Scheduler  và  các  process  của  LocalExecutor  phải  chia  sẻ  tài  nguyên  —  nếu  máy  không  đủ  mạnh,  hiệu  \nsuất\n \ncủa\n \nScheduler\n \ncó\n \nthể\n \nbị\n \nảnh\n \nhưởng.\n Số  lượng  task  có  thể  chạy  cùng  lúc  phụ  thuộc  vào  tham  số  parallelism (số  process  tối  đa  cho  phép  \ncùng\n \nhoạt\n \nđộng).\n \nLocalExecutor  có  hai  chế  độ  hoạt  động  tùy  thuộc  vào  cấu  hình  parallelism:  \n●  Chế  độ  không  giới  hạn  (Unlimited  Parallelism) :   Khi  bạn  đặt  parallelism  =  0 \n“Không  giới  hạn  số  process  —  cứ  có  task  là  tạo  process  mới  để  chạy.”  \nAirflow  Scheduler  gửi  1  task  →  LocalExecutor  tạo  1  process  riêng  biệt  (LocalWorker)  để  \nxử\n \nlý.\n \nKhi\n \ntask\n \nxong\n \n→\n \nprocess\n \nđó\n \ntự\n \ntắt\n.\n \nTask\n \ntiếp\n \ntheo\n \n→\n \ntạo\n \nprocess\n \nmới\n \nkhác\n.\n \nGiả  sử  bạn  có  100  task  cùng  lúc :",
  "đó\n \ntự\n \ntắt\n.\n \nTask\n \ntiếp\n \ntheo\n \n→\n \ntạo\n \nprocess\n \nmới\n \nkhác\n.\n \nGiả  sử  bạn  có  100  task  cùng  lúc :  \n●  Airflow  sẽ  tạo  100  process  cùng  một  lúc  để  chạy  song  song.  ●  CPU,  RAM  có  thể  bị  quá  tải  nếu  máy  yếu,  vì  mỗi  process  ngốn  tài  nguyên  riêng.  \n Ưu  điểm:  \n●  Linh  hoạt,  tận  dụng  tối  đa  tài  nguyên  có  sẵn.  ●  Không  cần  giới  hạn  cứng.  \n Nhược  điểm:  Dễ  gây  quá  tải  hệ  thống  nếu  số  task  nhiều  →  hàng  trăm  process  sinh  ra  cùng  lúc.  \n●  Chế  độ  giới  hạn  (Limited  Parallelism) :  Khi  parallelism  >  0,  vd  par  =  4 \n“Chỉ  có  4  process  được  tạo  ra  sẵn,  và  4  process  đó  sẽ  thay  nhau  xử  lý  các  task.”  \nCơ  chế:",
  "“Chỉ  có  4  process  được  tạo  ra  sẵn,  và  4  process  đó  sẽ  thay  nhau  xử  lý  các  task.”  \nCơ  chế:  \n●  Airflow  tạo  ra  4  process  cố  định  (gọi  là  QueuedLocalWorker ).  ●  Các  process  này  đọc  task  từ  một  hàng  đợi  (task_queue) .  ●  Khi  một  worker  rảnh  (vì  vừa  xong  task),  nó  lấy  task  tiếp  theo  từ  hàng  đợi  để  chạy.  ●  Khi  không  còn  task  →  Scheduler  gửi  “poison  token”  để  worker  biết  là  “đã  hết  việc”,  rồi  tự  dừng  \nan\n \ntoàn\n \nGiả  sử  có  10  task,  và  parallelism  =  4:  \n●  Airflow  khởi  tạo  4  process  chạy  4  task  đầu  tiên.  ●  Khi  1  trong  4  process  hoàn  thành  →  nó  lấy  tiếp  task  thứ  5,  rồi  task  6,  v.v…  ●  Tổng  cộng  vẫn  chỉ  có  4  process  hoạt  động  cùng  lúc  →  không  gây  quá  tải.  \nƯu\n \nđiểm:\n ●  Kiểm  soát  tốt  tài  nguyên  (CPU,  RAM).  ●  Ổn  định  hơn  cho  máy  có  cấu  hình  hạn  chế.",
  "Ưu\n \nđiểm:\n ●  Kiểm  soát  tốt  tài  nguyên  (CPU,  RAM).  ●  Ổn  định  hơn  cho  máy  có  cấu  hình  hạn  chế.  \nNhược  điểm:  Các  task  còn  lại  phải  xếp  hàng  đợi,  nên  thời  gian  hoàn  tất  tổng  thể  sẽ  lâu  hơn  (nếu  nhiều  \ntask\n \nmà\n parallelism thấp).",
  "Ưu  điểm  của  LocalExecutor  \nƯu  điểm  lớn  nhất  là  đơn  giản  và  dễ  triển  khai .  Người  dùng  không  cần  cài  đặt  message  broker,  không  \ncần\n \nworker\n \ncluster,\n \nmà\n \nvẫn\n \ncó\n \nkhả\n \nnăng\n \nchạy\n \nsong\n \nsong\n \nnhiều\n \ntask\n.\n \nLocalExecutor\n \ncũng\n \ngiúp\n \nđơn\n \ngiản\n \nhóa\n \nviệc\n \ntheo\n \ndõi\n \nlog,\n \nvì\n \ntoàn\n \nbộ\n \nlog\n \nvà\n \ntrạng\n \nthái\n \ntask\n \nđược\n \nlưu\n \ntập\n \ntrung\n \ntrên\n \nmột\n \nmáy.\n \nĐối\n \nvới\n \ncác\n \nnhóm\n \nnhỏ\n \nhoặc\n \nmôi\n \ntrường\n \nthử\n \nnghiệm,\n \nLocalExecutor\n \nmang\n \nlại\n \nsự\n \ncân\n \nbằng\n \ntốt\n \ngiữa\n \nhiệu\n \nnăng\n \nvà\n \nđộ\n \nphức\n \ntạp.\n \nNhược  điểm  của  LocalExecutor  \nNhược  điểm  chính  là  giới  hạn  tài  nguyên  và  khả  năng  mở  rộng .  Toàn  bộ  task  và  Scheduler  cùng  chia  \nsẻ\n \nCPU,\n \nRAM\n \nvà\n \nổ\n \nđĩa\n \ntrên\n \nmột\n \nnode\n \nduy\n \nnhất,\n \nnên\n \nkhi\n \nworkload\n \ntăng\n \ncao,\n \nhệ\n \nthống\n \ndễ\n \nbị\n \nquá\n \ntải.\n \nNgoài\n \nra,\n \nnếu\n \nmáy\n \nchủ\n \ngặp\n \nsự\n \ncố,\n \ntoàn\n \nbộ\n \npipeline\n \nsẽ\n \ndừng\n \nlại\n \n—\n \nkhông\n \ncó\n \nkhả\n \nnăng",
  "Ngoài\n \nra,\n \nnếu\n \nmáy\n \nchủ\n \ngặp\n \nsự\n \ncố,\n \ntoàn\n \nbộ\n \npipeline\n \nsẽ\n \ndừng\n \nlại\n \n—\n \nkhông\n \ncó\n \nkhả\n \nnăng\n \nchịu\n \nlỗi\n \nhoặc\n \nkhôi\n \nphục\n \ntự\n \nđộng\n \nnhư\n \ncác\n \nexecutor\n \nphân\n \ntán.\n \nViệc\n \nchạy\n \nquá\n \nnhiều\n \nprocess\n \nsong\n \nsong\n \ncũng\n \ncó\n \nthể\n \nkhiến\n \nhệ\n \nđiều\n \nhành\n \nvà\n \ncơ\n \nsở\n \ndữ\n \nliệu\n \nbị\n \nnghẽn\n \nkết\n \nnối.\n \nCeleryExecutor  \nCeleryExecutor  là  một  loại  executor  trong  Apache  Airflow  cho  phép  phân  tán  việc  thực  thi  task  ra  \nnhiều\n \nmáy\n \n(worker\n \nnode)\n \nkhác\n \nnhau.\n \nThay\n \nvì\n \nScheduler\n \ntrực\n \ntiếp\n \nchạy\n \ntask\n \ntrên\n \ncùng\n \nmáy\n \nnhư\n \nLocalExecutor,\n \nCeleryExecutor\n \nsử\n \ndụng\n \nmột\n \nhệ\n \nthống\n \ntrung\n \ngian\n \ngọi\n \nlà\n \nmessage\n \nbroker\n \n(thường\n \nlà\n \nRedis\n \nhoặc\n \nRabbitMQ)\n \nđể\n \ngửi\n \ncác\n \nnhiệm\n \nvụ\n \ntới\n \ncác\n \nworker.\n \nMỗi\n \nworker\n \nlắng\n \nnghe\n \nhàng\n \nđợi\n \n(queue),\n \nnhận\n \nnhiệm\n \nvụ\n \nvà\n \nthực\n \nthi\n \nđộc\n \nlập.\n \nMô\n \nhình\n \nnày\n \ngiúp\n \nAirflow\n \ncó\n \nthể\n \nxử\n \nlý\n \nsong\n \nsong\n \nkhối",
  "vụ\n \nvà\n \nthực\n \nthi\n \nđộc\n \nlập.\n \nMô\n \nhình\n \nnày\n \ngiúp\n \nAirflow\n \ncó\n \nthể\n \nxử\n \nlý\n \nsong\n \nsong\n \nkhối\n \nlượng\n \ncông\n \nviệc\n \nrất\n \nlớn,\n \nvượt\n \nxa\n \ngiới\n \nhạn\n \ncủa\n \nmột\n \nnode\n \nduy\n \nnhất.\n \nCeleryExecutor  phù  hợp  trong  các  môi  trường  production  quy  mô  lớn ,  nơi  có  nhiều  DAG  phức  tạp  và  \nhàng\n \ntrăm\n \nhoặc\n \nhàng\n \nnghìn\n \ntask\n \nchạy\n \nđồng\n \nthời.\n \nKhi\n \nworkload\n \ntăng,\n \nbạn\n \nchỉ\n \ncần\n \nthêm\n \ncác\n \nworker\n \nnode\n \nđể\n \nmở\n \nrộng\n \nhệ\n \nthống\n \n—\n \nđiều\n \nnày\n \ngọi\n \nlà\n \nscale-out\n \n(mở\n \nrộng\n \nngang).\n \nExecutor\n \nnày\n \ncũng\n \ntăng\n \ntính\n \nchịu\n \nlỗi\n \n(fault\n \ntolerance)\n:\n \nnếu\n \nmột\n \nworker\n \ngặp\n \nsự\n \ncố,\n \ncác\n \nworker\n \nkhác\n \nvẫn\n \ncó\n \nthể\n \ntiếp\n \ntục\n \nxử\n \nlý\n \nphần\n \ncông\n \nviệc\n \ncòn\n \nlại.\n \nNgoài\n \nra,\n \nnó\n \nhỗ\n \ntrợ\n \nphân\n \nloại\n \ntask\n \nqua\n \nnhiều\n \nhàng\n \nđợi\n \nkhác\n \nnhau,\n \ngiúp\n \nđiều\n \nphối\n \ntài\n \nnguyên\n \nhiệu\n \nquả.\n \nTuy\n \nnhiên,\n \nvới\n \nhệ\n \nthống\n \nnhỏ\n \nhoặc\n \nmôi\n \ntrường\n \nthử\n \nnghiệm,\n \nviệc\n \ndùng",
  "nguyên\n \nhiệu\n \nquả.\n \nTuy\n \nnhiên,\n \nvới\n \nhệ\n \nthống\n \nnhỏ\n \nhoặc\n \nmôi\n \ntrường\n \nthử\n \nnghiệm,\n \nviệc\n \ndùng\n \nCeleryExecutor\n \ncó\n \nthể\n \ngây\n \ndư\n \nthừa\n \nvì\n \nyêu\n \ncầu\n \nhạ\n \ntầng\n \nphức\n \ntạp\n \nhơn\n \nLocalExecutor.\n \nKhi  một  DAG  được  trigger,  Scheduler  phân  tích  các  task  đủ  điều  kiện  chạy  và  gửi  lệnh  thực  thi  \n(execute_async)  vào  message  broker .  Broker  xếp  các  lệnh  này  vào  queue  tương  ứng.  Các  worker  –",
  "vốn  đang  lắng  nghe  queue  –  nhận  lệnh,  thực  thi  task  trong  môi  trường  của  mình  và  ghi  kết  quả  vào  \nresult\n \nbackend\n.\n \nKhi\n \ntask\n \nhoàn\n \ntất,\n \ntrạng\n \nthái\n \nđược\n \nđồng\n \nbộ\n \nlại\n \nvề\n \nScheduler\n \nqua\n \nmetadata\n \ndatabase.\n \nNếu\n \nworker\n \ngặp\n \nsự\n \ncố\n \ngiữa\n \nchừng,\n \ntask\n \ncó\n \nthể\n \nđược\n \nđưa\n \nlại\n \nvào\n \nqueue\n \nđể\n \nmột\n \nworker\n \nkhác\n \nxử\n \nlý\n \n(tùy\n \ncấu\n \nhình).\n \nCơ\n \nchế\n \nnày\n \ngiúp\n \nCeleryExecutor\n \nđảm\n \nbảo\n \ntính\n \ntoàn\n \nvẹn\n \nvà\n \nliên\n \ntục\n \ncủa\n \nworkflow\n \nngay\n \ncả\n \nkhi\n \ncó\n \nnode\n \ngặp\n \nlỗi.\n \nƯu  điểm  của  CeleryExecutor  \nCeleryExecutor  nổi  bật  với  khả  năng  mở  rộng  linh  hoạt  (scalability) .  Chỉ  cần  thêm  hoặc  bớt  worker,  \nbạn\n \ncó\n \nthể\n \nnhanh\n \nchóng\n \nthích\n \nứng\n \nvới\n \nkhối\n \nlượng\n \ncông\n \nviệc\n \nthay\n \nđổi.\n \nHơn\n \nnữa,\n \nnó\n \ntăng\n \nkhả\n \nnăng\n \nchịu\n \nlỗi\n:\n \nnếu\n \nmột\n \nworker\n \nngừng\n \nhoạt\n \nđộng,\n \ncác\n \nworker\n \nkhác\n \nsẽ\n \ntiếp\n \nnhận\n \nphần\n \nviệc\n \ncòn\n \nlại\n \nmà\n \nkhông\n \nlàm\n \ngián",
  "ngừng\n \nhoạt\n \nđộng,\n \ncác\n \nworker\n \nkhác\n \nsẽ\n \ntiếp\n \nnhận\n \nphần\n \nviệc\n \ncòn\n \nlại\n \nmà\n \nkhông\n \nlàm\n \ngián\n \nđoạn\n \ntoàn\n \nhệ\n \nthống.\n \nNgoài\n \nra,\n \nviệc\n \nsử\n \ndụng\n \nnhiều\n \nqueue\n \ngiúp\n \nbạn\n \nphân\n \nloại\n \nvà\n \nưu\n \ntiên\n \ntask\n \n—\n \nví\n \ndụ:\n \nqueue\n \ndành\n \ncho\n \ntác\n \nvụ\n \nnhẹ,\n \nqueue\n \ndành\n \ncho\n \ntác\n \nvụ\n \nnặng.\n \nTính\n \nlinh\n \nhoạt\n \nnày\n \nkhiến\n \nCeleryExecutor\n \ntrở\n \nthành\n \ntiêu\n \nchuẩn\n \nphổ\n \nbiến\n \nnhất\n \ntrong\n \ncác\n \nhệ\n \nthống\n \nAirflow\n \nproduction.\n \nNhược  điểm  của  CeleryExecutor  \nĐiểm  yếu  lớn  nhất  của  CeleryExecutor  là  độ  phức  tạp  trong  triển  khai  và  vận  hành .  Bạn  phải  cài  đặt  \nvà\n \nquản\n \nlý\n \nthêm\n \nmessage\n \nbroker,\n \nresult\n \nbackend,\n \nvà\n \nnhiều\n \nworker\n \nnode.\n \nTất\n \ncả\n \ncác\n \nworker\n \ncần\n \ncó\n \ncùng\n \nmôi\n \ntrường,\n \ncùng\n \nDAGs,\n \ncùng\n \ndependencies\n \n—\n \nnếu\n \nsai\n \nkhác\n \nnhỏ\n \ncũng\n \ncó\n \nthể\n \nkhiến\n \ntask\n \nthất\n \nbại.\n \nNgoài\n \nra,\n \nviệc\n \ngiám\n \nsát\n \n(monitoring)\n \nhệ\n \nthống\n \nCelery\n \nphức\n \ntạp",
  "thể\n \nkhiến\n \ntask\n \nthất\n \nbại.\n \nNgoài\n \nra,\n \nviệc\n \ngiám\n \nsát\n \n(monitoring)\n \nhệ\n \nthống\n \nCelery\n \nphức\n \ntạp\n \nhơn:\n \nbạn\n \nphải\n \ntheo\n \ndõi\n \nbroker,\n \nqueue,\n \nworker\n \nhealth,\n \nvà\n \nlogs\n \ntrên\n \nnhiều\n \nnode.\n \nKhi\n \nworkload\n \ntăng\n \nđột\n \nbiến\n \nmà\n \nchưa\n \ncó\n \ncơ\n \nchế\n \nauto-scaling,\n \nqueue\n \ncó\n \nthể\n \nbị\n \n“tắc\n \nnghẽn”,\n \ngây\n \ndelay\n \ntrong\n \nthực\n \nthi\n \ntask.\n \nKubernetesExecutor  \nKubernetesExecutor  là  một  loại  executor  trong  Apache  Airflow  được  thiết  kế  để  tận  dụng  hạ  tầng  \nKubernetes\n \nnhằm\n \nchạy\n \ncác\n \ntask\n \ntrong\n \nmôi\n \ntrường\n \ncontainer\n \nhóa\n.\n \nKhi\n \nsử\n \ndụng\n \nexecutor\n \nnày,\n \nmỗi\n \ntask\n \ncủa\n \nAirflow\n \nsẽ\n \nđược\n \nchạy\n \ntrong\n \nmột\n \nPod\n \nriêng\n \nbiệt\n \ntrong\n \ncluster\n \nKubernetes.\n \nPod\n \nlà\n \nđơn\n \nvị\n \ntriển\n \nkhai\n \n(deployment\n \nunit)\n \nnhỏ\n \nnhất.\n \nMột\n \nPod\n \ncó\n \nthể\n \nchứa\n \nmột\n \nhoặc\n \nnhiều\n \ncontainer\n,\n \nthường\n \nlà\n \ncác\n \ncontainer\n \ncần\n \nchạy\n \ncùng\n \nnhau\n \nvà\n \nchia\n \nsẻ\n \nchung\n \ntài\n \nnguyên\n \n(như",
  "container\n,\n \nthường\n \nlà\n \ncác\n \ncontainer\n \ncần\n \nchạy\n \ncùng\n \nnhau\n \nvà\n \nchia\n \nsẻ\n \nchung\n \ntài\n \nnguyên\n \n(như\n \nnetwork,\n \nvolume,\n \nhoặc\n \ncấu\n \nhình).\n \nNhư\n \nvậy,\n \nmỗi\n \nPod\n \nchính\n \nlà\n \n“máy\n \nảo\n \ntạm\n \nthời”\n \ncủa\n \ntask\n \n—\n \nnó\n \nsinh\n \nra\n \nkhi\n \ntask\n \nbắt\n \nđầu\n \nvà\n \nbiến\n \nmất\n \nkhi\n \ntask\n \nkết\n \nthúc.\n \nĐiều\n \nnày\n \ngiúp\n \nđảm\n \nbảo\n \nsự\n \ncách\n \nly\n \ntài\n \nnguyên\n,\n \nkhả\n \nnăng\n \nmở\n \nrộng\n \nlinh\n \nhoạt\n,\n \nvà\n \ntận\n \ndụng\n \ncác\n \ntính\n \nnăng\n \nnhư\n \nautoscaling\n \nhoặc\n \nresource\n \nlimit\n \ncủa\n \nKubernetes.\n \nNói\n \ncách\n \nkhác,\n \nthay\n \nvì\n \ndùng\n \nworker\n \ncố\n \nđịnh\n \n(như\n \nCeleryExecutor)\n \nhoặc\n \nprocess\n \ncục\n \nbộ\n \n(như\n \nLocalExecutor),\n \nKubernetesExecutor\n \nkhởi\n \ntạo\n \nPod\n \nmới\n \ncho\n \nmỗi\n \ntask\n \nvà\n \ntự\n \nđộng\n \nhủy\n \nPod\n \nsau\n \nkhi\n \ntask\n \nhoàn\n \ntất.",
  "KubernetesExecutor  phù  hợp  nhất  trong  các  hệ  thống  đã  được  triển  khai  trên  Kubernetes  hoặc  có  hạ  \ntầng\n \ncloud-native\n \nsẵn.\n \nExecutor\n \nnày\n \nđặc\n \nbiệt\n \nhiệu\n \nquả\n \nkhi\n \nbạn\n \ncần\n \nxử\n \nlý\n \nnhiều\n \ntask\n \ncó\n \nyêu\n \ncầu\n \ntài\n \nnguyên\n \nkhác\n \nnhau\n,\n \ncần\n \nmở\n \nrộng\n \ntự\n \nđộng\n,\n \nhoặc\n \nmuốn\n \nmỗi\n \ntask\n \nchạy\n \ntrong\n \nmôi\n \ntrường\n \ncô\n \nlập\n \nhoàn\n \ntoàn\n.\n \nVí\n \ndụ,\n \ntrong\n \nmôi\n \ntrường\n \nproduction\n \nvới\n \nnhiều\n \nDAG\n \nphức\n \ntạp,\n \nKubernetesExecutor\n \ngiúp\n \ntối\n \nưu\n \nhóa\n \nviệc\n \nphân\n \nphối\n \ntài\n \nnguyên\n \nvà\n \nhạn\n \nchế\n \nxung\n \nđột\n \ngiữa\n \ncác\n \ntask.\n \nTuy\n \nnhiên,\n \nnếu\n \nbạn\n \nchỉ\n \nvận\n \nhành\n \nAirflow\n \ntrên\n \nmột\n \nserver\n \nđơn\n \nhoặc\n \nworkload\n \nnhỏ,\n \nviệc\n \nthiết\n \nlập\n \nKubernetesExecutor\n \nsẽ\n \ntrở\n \nnên\n \ndư\n \nthừa\n \nvà\n \nphức\n \ntạp\n \nkhông\n \ncần\n \nthiết.\n \nQuy  trình  thực  thi  trong  KubernetesExecutor  diễn  ra  theo  các  bước  sau:",
  "phức\n \ntạp\n \nkhông\n \ncần\n \nthiết.\n \nQuy  trình  thực  thi  trong  KubernetesExecutor  diễn  ra  theo  các  bước  sau:  \n1.  Scheduler  xác  định  task  sẵn  sàng  chạy  và  gửi  lệnh  tới  KubernetesExecutor.  2.  Executor  sử  dụng  Kubernetes  API  để  tạo  một  Pod  mới  dựa  trên  pod_template_file.  3.  Task  được  thực  thi  bên  trong  container  của  Pod  đó.  4.  Khi  task  hoàn  tất  (dù  thành  công  hay  thất  bại),  Pod  gửi  trạng  thái  về  cho  Scheduler,  và  nếu  được  \ncấu\n \nhình,\n \nPod\n \nsẽ\n \ntự\n \nđộng\n \nbị\n \nxóa\n \nđể\n \ngiải\n \nphóng\n \ntài\n \nnguyên.\n 5.  Scheduler  cập  nhật  thông  tin  trạng  thái  vào  metadata  database.  \n \nCơ\n \nchế\n \nnày\n \ngiúp\n \nAirflow\n \nđạt\n \nđược\n \ntính\n \n“tạm\n \nthời”\n \n(ephemeral\n \nexecution):\n \nmỗi\n \ntask\n \nchỉ\n \ntồn\n \ntại\n \ntrong\n \nthời\n \ngian\n \nthực\n \nthi,\n \nsau\n \nđó\n \ntài\n \nnguyên\n \nđược\n \nthu\n \nhồi.\n \nTuy\n \nnhiên,\n \nviệc\n \nkhởi\n \ntạo\n \nPod\n \nmới\n \ncó\n \nthể\n \ngây\n \nđộ\n \ntrễ\n \nnhất\n \nđịnh,\n \nđặc\n \nbiệt\n \nkhi\n \ncluster\n \nbận\n \nhoặc",
  "việc\n \nkhởi\n \ntạo\n \nPod\n \nmới\n \ncó\n \nthể\n \ngây\n \nđộ\n \ntrễ\n \nnhất\n \nđịnh,\n \nđặc\n \nbiệt\n \nkhi\n \ncluster\n \nbận\n \nhoặc\n \nimage\n \ncontainer\n \nlớn.\n \nƯu  điểm  của  KubernetesExecutor  \nKubernetesExecutor  mang  lại  nhiều  lợi  ích  vượt  trội  so  với  các  executor  khác.  Thứ  nhất,  nó  cho  phép  \nmở\n \nrộng\n \nlinh\n \nhoạt\n \n–\n \nkhi\n \nsố\n \nlượng\n \ntask\n \ntăng,\n \nhệ\n \nthống\n \ncó\n \nthể\n \ntự\n \nđộng\n \ntạo\n \nthêm\n \nPod\n \nđể\n \nxử\n \nlý\n \nmà\n \nkhông\n \ncần\n \ncan\n \nthiệp\n \nthủ\n \ncông.\n \nThứ\n \nhai,\n \nnó\n \nđảm\n \nbảo\n \ncách\n \nly\n \ntài\n \nnguyên\n \ntuyệt\n \nđối:\n \nmỗi\n \ntask\n \nchạy\n \ntrong\n \ncontainer\n \nriêng\n \nnên\n \nkhông\n \nảnh\n \nhưởng\n \nđến\n \ntask\n \nkhác.\n \nThứ\n \nba,\n \nviệc\n \ntích\n \nhợp\n \nsâu\n \nvới\n \nhệ\n \nsinh\n \nthái\n \nKubernetes\n \ngiúp\n \ntận\n \ndụng\n \ncác\n \ntính\n \nnăng\n \nnhư\n \nautoscaling,\n \nnode\n \nscheduling,\n \nvà\n \nresource\n \nquota.\n \nNgoài\n \nra,\n \nsau\n \nkhi\n \ntask\n \nkết\n \nthúc,\n \nPod\n \nđược\n \ntự\n \nđộng\n \ndọn\n \ndẹp,\n \ngiúp\n \ngiảm\n \nthiểu\n \nchi\n \nphí\n \ntài\n \nnguyên\n \nkhông\n \ncần\n \nthiết.",
  "thúc,\n \nPod\n \nđược\n \ntự\n \nđộng\n \ndọn\n \ndẹp,\n \ngiúp\n \ngiảm\n \nthiểu\n \nchi\n \nphí\n \ntài\n \nnguyên\n \nkhông\n \ncần\n \nthiết.\n \nNhược  điểm  và  hạn  chế  \nMặc  dù  mạnh  mẽ,  KubernetesExecutor  có  một  số  hạn  chế.  Thời  gian  khởi  tạo  Pod  thường  lâu  hơn  các  \nexecutor\n \nkhác\n \ndo\n \nphải\n \ngửi\n \nyêu\n \ncầu\n \ntới\n \nAPI,\n \nkéo\n \nimage\n \ncontainer,\n \nvà\n \nchờ\n \nPod\n \nđược\n \nlên\n \nlịch.\n \nNếu\n \nimage\n \nlớn\n \nhoặc\n \ncluster\n \nđang\n \ntải\n \ncao,\n \nđộ\n \ntrễ\n \nnày\n \ncó\n \nthể\n \nlên\n \ntới\n \nhàng\n \nchục\n \ngiây\n \nhoặc\n \nvài\n \nphút.\n \nBên\n \ncạnh\n \nđó,\n \nviệc\n \ntriển\n \nkhai\n \nvà\n \nvận\n \nhành\n \nAirflow\n \ntrên\n \nKubernetes\n \nđòi\n \nhỏi\n \nkiến\n \nthức\n \nhệ\n \nthống\n \ncao\n \nhơn,\n \nbao\n \ngồm\n \ncấu\n \nhình\n \nvolumes,\n \nnetworking,\n \nvà\n \nquyền\n \ntruy\n \ncập\n \ncluster.\n \nNgoài\n \nra,\n \nchi\n \nphí\n \ntài\n \nnguyên\n \nvà\n \nbảo\n \ntrì\n \ncũng\n \ncao\n \nhơn\n \n–\n \nđặc\n \nbiệt\n \nkhi\n \nsố\n \nlượng\n \ntask\n \nlớn\n \ndẫn\n \nđến\n \nhàng\n \ntrăm\n \nPod\n \nđược\n \ntạo\n \nvà\n \nxóa\n \nliên\n \ntục.\n \nƯu  điểm  và  nhược  điểm  của  Airflow",
  "lớn\n \ndẫn\n \nđến\n \nhàng\n \ntrăm\n \nPod\n \nđược\n \ntạo\n \nvà\n \nxóa\n \nliên\n \ntục.\n \nƯu  điểm  và  nhược  điểm  của  Airflow  \nƯu  điểm   \n1.  “Workflow  as  Code”  –  Mọi  thứ  đều  là  mã  nguồn \nAirflow  cho  phép  bạn  định  nghĩa  toàn  bộ  pipeline  dữ  liệu  dưới  dạng  mã  Python.  Điều  này  không  \nchỉ\n \ngiúp\n \nbạn\n \nkiểm\n \nsoát\n \nlogic\n \nmột\n \ncách\n \nchi\n \ntiết\n \nmà\n \ncòn\n \ncho\n \nphép\n \ntái\n \nsử\n \ndụng,\n \nkiểm\n \nthử\n \nvà\n \nversion\n \nhóa\n \ndễ\n \ndàng.\n \nGiả\n \nsử\n \nbạn\n \ncần\n \nxử\n \nlý\n \ndữ\n \nliệu\n \ntừ\n \n30\n \nnguồn\n \nkhác\n \nnhau,\n \nmỗi\n \nnguồn\n \ncó\n \ncấu\n \ntrúc\n \nvà\n \ntham\n \nsố\n \nriêng.\n \nThay\n \nvì\n \ntạo\n \n30\n \nDAG\n \ntĩnh,\n \nbạn\n \ncó\n \nthể\n \nviết\n \nmột\n \nđoạn\n \nmã\n \nPython\n \nsử\n \ndụng\n \nvòng\n \nlặp",
  "để  tự  động  tạo  ra  30  DAG  tương  ứng,  mỗi  DAG  nhận  tham  số  riêng  biệt.  Điều  này  giúp  giảm  \nthiểu\n \nviệc\n \nlặp\n \nlại\n \nmã\n \nnguồn\n \nvà\n \ndễ\n \ndàng\n \nbảo\n \ntrì\n \nkhi\n \ncó\n \nthay\n \nđổi.\n \n2.  Khả  năng  tích  hợp  cao  (Hooks,  Operators,  Providers) \nAirflow  cung  cấp  một  hệ  sinh  thái  phong  phú  các  hooks,  operators  và  providers  giúp  kết  nối  với  \nnhiều\n \nhệ\n \nthống\n \nbên\n \nngoài\n \nnhư\n \nS3,\n \nRedshift,\n \nSlack,\n \nKubernetes,\n \nv.v.\n \nBạn\n \nchỉ\n \ncần\n \ncấu\n \nhình\n \nkết\n \nnối\n \nmà\n \nkhông\n \ncần\n \nphải\n \nviết\n \nlại\n \nmã\n \nkết\n \nnối\n \ntừ\n \nđầu.\n \nGiả\n \nsử\n \nbạn\n \ncó\n \nmột\n \nDAG\n \ncần\n \nthực\n \nhiện\n \ncác\n \nbước\n \nsau:\n \n1.  Đọc  dữ  liệu  từ  S3.  2.  Nhập  dữ  liệu  vào  Redshift.  3.  Gửi  thông  báo  qua  Slack  nếu  có  lỗi  \nVới  Airflow,  bạn  có  thể  sử  dụng  S3Hook để  kết  nối  với  S3,  RedshiftOperator để  thực  hiện  \nthao\n \ntác\n \ntrên\n \nRedshift\n \nvà\n SlackAPIPostOperator để  gửi  thông  báo.  Việc  này  giúp  bạn  dễ  \ndàng\n \ntích\n \nhợp\n \nvà",
  "trên\n \nRedshift\n \nvà\n SlackAPIPostOperator để  gửi  thông  báo.  Việc  này  giúp  bạn  dễ  \ndàng\n \ntích\n \nhợp\n \nvà\n \nquản\n \nlý\n \ncác\n \nhệ\n \nthống\n \nbên\n \nngoài\n \nmà\n \nkhông\n \ncần\n \nphải\n \nlo\n \nlắng\n \nvề\n \nviệc\n \nxử\n \nlý\n \nkết\n \nnối\n \nphức\n \ntạp.\n \n3.  Khả  năng  mở  rộng  &  chạy  song  song  (Scalability,  Concurrency)\n \nAirflow\n \nhỗ\n \ntrợ\n \nmở\n \nrộng\n \ntheo\n \nchiều\n \nngang,\n \ncho\n \nphép\n \nbạn\n \nchạy\n \nhàng\n \nnghìn\n \ntask\n \nđồng\n \nthời\n \ntrên\n \nnhiều\n \nworker\n \nkhác\n \nnhau.\n \nĐiều\n \nnày\n \ngiúp\n \ngiảm\n \nthời\n \ngian\n \nthực\n \nthi\n \npipeline\n \nvà\n \ntối\n \nưu\n \nhóa\n \ntài\n \nnguyên\n \nhệ\n \nthống.\n \nGiả\n \nsử\n \nbạn\n \ncó\n \nmột\n \nDAG\n \nvới\n \n100\n \ntask\n \nđộc\n \nlập,\n \nkhông\n \ncó\n \nphụ\n \nthuộc\n \nlẫn\n \nnhau.\n \nAirflow\n \ncó\n \nthể\n \nphân\n \nphối\n \ncác\n \ntask\n \nnày\n \ncho\n \nnhiều\n \nworker,\n \ngiúp\n \nchúng\n \nchạy\n \nsong\n \nsong\n \nvà\n \nhoàn\n \nthành\n \nnhanh\n \nchóng.\n \nBạn\n \ncó\n \nthể\n \ncấu\n \nhình\n \nsố\n \nlượng\n \nworker\n \nvà\n \nmức\n \nđộ\n \nsong\n \nsong\n \ntối\n \nđa\n \ncho\n \nmỗi\n \nDAG\n \nhoặc\n \ntask\n \nđể\n \ntối\n \nưu",
  "hình\n \nsố\n \nlượng\n \nworker\n \nvà\n \nmức\n \nđộ\n \nsong\n \nsong\n \ntối\n \nđa\n \ncho\n \nmỗi\n \nDAG\n \nhoặc\n \ntask\n \nđể\n \ntối\n \nưu\n \nhóa\n \nhiệu\n \nsuất.\n \n4.  Giao  diện  quản  lý  &  theo  dõi  (UI,  Logging,  Monitoring) \nAirflow  cung  cấp  giao  diện  web  trực  quan  giúp  bạn  dễ  dàng  theo  dõi  trạng  thái  của  các  DAG  và  \ntask,\n \nxem\n \nlog\n \nchi\n \ntiết\n \nvà\n \nthực\n \nhiện\n \ncác\n \nthao\n \ntác\n \nnhư\n \nrerun,\n \npause,\n \nresume.\n \nKhi\n \nmột\n \ntask\n \ntrong\n \nDAG\n \nthất\n \nbại,\n \nbạn\n \ncó\n \nthể\n \ntruy\n \ncập\n \ngiao\n \ndiện\n \nweb\n \ncủa\n \nAirflow\n \nđể\n \nxem\n \nlog\n \nchi\n \ntiết,\n \nxác\n \nđịnh\n \nnguyên\n \nnhân\n \ngây\n \nlỗi\n \nvà\n \nthực\n \nhiện\n \ncác\n \nthao\n \ntác\n \nnhư\n \nrerun\n \nhoặc\n \nsửa\n \nlỗi\n \ntrực\n \ntiếp\n \ntừ\n \ngiao\n \ndiện\n \nmà\n \nkhông\n \ncần\n \nphải\n \ncan\n \nthiệp\n \nvào\n \nmã\n \nnguồn.\n \n5.  API  (REST  API)  để  trigger  /  quản  lý  từ  bên  ngoài \nAirflow  cung  cấp  REST  API  cho  phép  bạn  trigger  DAG,  truy  vấn  trạng  thái  và  thực  hiện  các  thao  \ntác\n \nkhác\n \ntừ\n \nbên\n \nngoài,\n \ngiúp",
  "tác\n \nkhác\n \ntừ\n \nbên\n \nngoài,\n \ngiúp\n \ntích\n \nhợp\n \nlinh\n \nhoạt\n \nvới\n \ncác\n \nhệ\n \nthống\n \nkhác\n \nnhư\n \nCI/CD,\n \ndashboard,\n \nv.v.\n \nKhi\n \ncó\n \ndữ\n \nliệu\n \nmới\n \nđược\n \ntải\n \nlên\n \nhệ\n \nthống,\n \nbạn\n \ncó\n \nthể\n \ncấu\n \nhình\n \nđể\n \nhệ\n \nthống\n \ntự\n \nđộng\n \ngọi\n \nAPI\n \ncủa\n \nAirflow\n \nđể\n \ntrigger\n \nmột\n \nDAG\n \nxử\n \nlý\n \ndữ\n \nliệu\n \nmới.\n \nĐiều\n \nnày\n \ngiúp\n \ntự\n \nđộng\n \nhóa\n \nquy\n \ntrình\n \nvà\n \ngiảm\n \nthiểu\n \nsự\n \ncan\n \nthiệp\n \nthủ\n \ncông.\n \n6.  Cộng  đồng  &  mã  nguồn  mở \nAirflow  là  một  dự  án  mã  nguồn  mở  với  cộng  đồng  người  dùng  và  phát  triển  rộng  lớn.  Bạn  có  thể  \nđóng\n \ngóp,\n \nsử\n \ndụng\n \nvà\n \ntùy\n \nchỉnh\n \nAirflow\n \ntheo\n \nnhu\n \ncầu\n \nmà\n \nkhông\n \nlo\n \nbị\n \nràng\n \nbuộc\n \nbởi\n \nnhà\n \ncung\n \ncấp.\n \nNếu\n \nbạn\n \ncần\n \nmột\n \noperator\n \nđể\n \nkết\n \nnối\n \nvới\n \nmột\n \nhệ\n \nthống\n \nnội\n \nbộ\n \nchưa\n \nđược\n \nhỗ\n \ntrợ\n \nsẵn,\n \nbạn\n \ncó\n \nthể",
  "tự  phát  triển  operator  đó  hoặc  tìm  kiếm  trong  cộng  đồng  để  xem  có  ai  đã  phát  triển  và  chia  sẻ  \nchưa.\n \nĐiều\n \nnày\n \ngiúp\n \nbạn\n \nlinh\n \nhoạt\n \ntrong\n \nviệc\n \nmở\n \nrộng\n \nvà\n \ntùy\n \nchỉnh\n \nAirflow\n \ntheo\n \nnhu\n \ncầu\n \nriêng.\n \n7.  Miễn  phí  license  phần  mềm \nAirflow  là  phần  mềm  mã  nguồn  mở,  miễn  phí  sử  dụng.  Bạn  chỉ  cần  chi  trả  cho  chi  phí  hạ  tầng  và  \nvận\n \nhành,\n \ngiúp\n \ngiảm\n \nchi\n \nphí\n \nban\n \nđầu\n \nkhi\n \ntriển\n \nkhai.\n \nKhi\n \ntriển\n \nkhai\n \nAirflow\n \ntrên\n \nhệ\n \nthống\n \ncủa\n \nmình,\n \nbạn\n \nkhông\n \nphải\n \ntrả\n \nphí\n \nbản\n \nquyền\n \ncho\n \nphần\n \nmềm.\n \nThay\n \nvào\n \nđó,\n \nbạn\n \nchỉ\n \ncần\n \nđầu\n \ntư\n \nvào\n \nhạ\n \ntầng\n \nnhư\n \nmáy\n \nchủ,\n \nlưu\n \ntrữ\n \nvà\n \nchi\n \nphí\n \nvận\n \nhành,\n \ngiúp\n \ntối\n \nưu\n \nhóa\n \nchi\n \nphí\n \ntriển\n \nkhai.\n \nHạn  chế\n \n2.  Triển  khai  và  vận  hành  phức  tạp \nAirflow  yêu  cầu  cấu  hình  và  duy  trì  nhiều  thành  phần  như  metadata  database  \n(PostgreSQL/MySQL),\n \nScheduler,\n \nWebserver,\n \nWorker",
  "(PostgreSQL/MySQL),\n \nScheduler,\n \nWebserver,\n \nWorker\n \n(CeleryExecutor/Kubernetes),\n \nmessage\n \nbroker\n \n(Redis/RabbitMQ),\n \nvà\n \ncác\n \nthành\n \nphần\n \nkhác.\n \nViệc\n \nmột\n \nthành\n \nphần\n \ngặp\n \nsự\n \ncố\n \ncó\n \nthể\n \nảnh\n \nhưởng\n \nđến\n \ntoàn\n \nbộ\n \npipeline.\n \nTrong\n \nmôi\n \ntrường\n \nproduction,\n \nnếu\n \nmessage\n \nbroker\n \ngặp\n \nsự\n \ncố,\n \ncác\n \ntask\n \ntrong\n \nDAG\n \ncó\n \nthể\n \nkhông\n \nđược\n \nthực\n \nthi,\n \ndẫn\n \nđến\n \ngián\n \nđoạn\n \ntrong\n \npipeline\n \ndữ\n \nliệu.\n \n→\n \nĐể\n \ngiảm\n \nthiểu\n \nrủi\n \nro,\n \nngười\n \ndùng\n \nnên\n \nthiết\n \nlập\n \ngiám\n \nsát\n \nvà\n \ncảnh\n \nbáo\n \ncho\n \ncác\n \nthành\n \nphần\n \nquan\n \ntrọng,\n \ncũng\n \nnhư\n \nthực\n \nhiện\n \nsao\n \nlưu\n \nvà\n \nphục\n \nhồi\n \nđịnh\n \nkỳ\n \nđể\n \nđảm\n \nbảo\n \ntính\n \nsẵn\n \nsàng\n \nvà\n \nổn\n \nđịnh\n \ncủa\n \nhệ\n \nthống.\n \n3.  Thiếu  khả  năng  versioning  workflow  và  khó  rollback \nAirflow  không  cung  cấp  tính  năng  versioning  cho  các  DAG,  điều  này  có  thể  gây  khó  khăn  khi  cần  \nquay\n \nlại\n \nphiên\n \nbản\n \ntrước\n \ncủa\n \npipeline\n \nhoặc\n \nkhi\n \ncó",
  "quay\n \nlại\n \nphiên\n \nbản\n \ntrước\n \ncủa\n \npipeline\n \nhoặc\n \nkhi\n \ncó\n \nsự\n \ncố\n \nxảy\n \nra.\n \nKhi\n \nchỉnh\n \nsửa\n \nmột\n \nDAG\n \nvà\n \ndeploy,\n \ncác\n \ntask\n \ncũ\n \ncó\n \nthể\n \nbị\n \nmất,\n \nvà\n \nkhông\n \nthể\n \ndễ\n \ndàng\n \nquay\n \nlại\n \ntrạng\n \nthái\n \ntrước\n \nđó.\n \n→\n \nNgười\n \ndùng\n \nnên\n \nquản\n \nlý\n \nDAGs\n \nbằng\n \nhệ\n \nthống\n \nkiểm\n \nsoát\n \nphiên\n \nbản\n \nnhư\n \nGit,\n \ntạo\n \nnhánh\n \nvà\n \ncommit\n \nthường\n \nxuyên\n \nđể\n \ncó\n \nthể\n \nquay\n \nlại\n \nphiên\n \nbản\n \ntrước\n \nkhi\n \ncần\n \nthiết.\n \n4.  Giám  sát  chất  lượng  dữ  liệu  hạn  chế \nAirflow  chủ  yếu  tập  trung  vào  việc  điều  phối  pipeline  và  không  cung  cấp  các  công  cụ  tích  hợp  sẵn  \nđể\n \nkiểm\n \ntra\n \nchất\n \nlượng\n \ndữ\n \nliệu.\n \nAirflow\n \ncó\n \nthể\n \nbáo\n \ncáo\n \nmột\n \ntask\n \nthành\n \ncông,\n \nnhưng\n \nkhông\n \nthể\n \nxác\n \nnhận\n \nliệu\n \ndữ\n \nliệu\n \nđầu\n \nra\n \ncó\n \nđúng\n \nđịnh\n \ndạng,\n \nkhông\n \ncó\n \ngiá\n \ntrị\n \nnull\n \nhay\n \nkhông.\n \n→\n \nNgười\n \ndùng\n \nnên\n \ntích\n \nhợp\n \ncác\n \ncông\n \ncụ\n \nkiểm\n \ntra\n \nchất\n \nlượng\n \ndữ\n \nliệu\n \nnhư\n \nGreat",
  "không.\n \n→\n \nNgười\n \ndùng\n \nnên\n \ntích\n \nhợp\n \ncác\n \ncông\n \ncụ\n \nkiểm\n \ntra\n \nchất\n \nlượng\n \ndữ\n \nliệu\n \nnhư\n \nGreat\n \nExpectations\n \nhoặc\n \ndbt\n \nđể\n \nđảm\n \nbảo\n \ndữ\n \nliệu\n \nđầu\n \nra\n \nđạt\n \nchất\n \nlượng\n \nmong\n \nmuốn.\n \n6.  Không  phù  hợp  cho  workflows  trạng  thái  hoặc  streaming \n \nAirflow  được  thiết  kế  chủ  yếu  cho  các  pipeline  batch,  không  phải  cho  các  workflows  trạng  thái  \nhoặc\n \nstreaming.\n \nNếu\n \ncần\n \nxử\n \nlý\n \ndữ\n \nliệu\n \nstreaming\n \ntừ\n \nKafka\n \nhoặc\n \nxử\n \nlý\n \nthời\n \ngian\n \nthực,\n \nAirflow\n \nkhông\n \nphải\n \nlà\n \ncông\n \ncụ\n \nlý\n \ntưởng,\n \nvà\n \nviệc\n \ntích\n \nhợp\n \nthêm\n \nhệ\n \nthống\n \nkhác\n \nnhư\n \nFlink\n \nhoặc\n \nSpark",
  "Streaming  có  thể  phức  tạp.  →  Người  dùng  nên  sử  dụng  Airflow  để  điều  phối  các  task  batch  và  \ntích\n \nhợp\n \nvới\n \ncác\n \nhệ\n \nthống\n \nchuyên\n \ndụng\n \ncho\n \nstreaming\n \nđể\n \nxử\n \nlý\n \ndữ\n \nliệu\n \nthời\n \ngian\n \nthực.\n \n7.  Hạn  chế  trên  Windows \nAirflow  không  hỗ  trợ  chạy  natively  trên  Windows,  điều  này  có  thể  gây  khó  khăn  trong  việc  phát  \ntriển\n \nvà\n \nthử\n \nnghiệm\n \ntrên\n \nmôi\n \ntrường\n \nWindows.\n \nĐể\n \nchạy\n \nAirflow\n \ntrên\n \nWindows,\n \nngười\n \ndùng\n \nthường\n \nphải\n \nsử\n \ndụng\n \nDocker\n \nhoặc\n \nWindows\n \nSubsystem\n \nfor\n \nLinux\n \n(WSL),\n \nđiều\n \nnày\n \ncó\n \nthể\n \nphức\n \ntạp\n \nvà\n \nkhông\n \nthuận\n \ntiện.\n \n→\n \nNgười\n \ndùng\n \nnên\n \nphát\n \ntriển\n \nvà\n \nthử\n \nnghiệm\n \ntrên\n \nmôi\n \ntrường\n \nLinux\n \nhoặc\n \nsử\n \ndụng\n \ncác\n \ncông\n \ncụ\n \nnhư\n \nDocker\n \nđể\n \ntạo\n \nmôi\n \ntrường\n \nphát\n \ntriển\n \ntương\n \ntự\n \nnhư\n \nproduction."
]